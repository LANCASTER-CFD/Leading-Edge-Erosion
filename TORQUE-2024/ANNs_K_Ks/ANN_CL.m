%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           --- LEE2AERO ---                              %
% Opensource machine learning based tool for assessing blade performance  % 
%          impairment due to general leading edge degradation             %                      
%                           ----------------                              %
%                              Software by:                               %
%        Alessio Castorrini, Andrea Ortolani, Edmondo Minisci,            %
%                         M. Sergio Campobasso                            %
%                                                                         %
%                          Reference article:                             %
% Opensource machine learning metamodels for assessing blade performance  %
% impairment due to general leading edge degradation, Journal of Physics: % 
% Conference Series, Vol. xxxx, no.x, ref. xxxxxx, June 2024. DOI: xxxxxxxxx.
%                                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [Y,Xf,Af] = ANN_CL(X,~,~)
% ANN_CL neural network simulation function.
%
% Auto-generated by MATLAB, 22-Mar-2024 01:18:40.
% 
% [Y] = myNNF_Cl_R_AF1_KKs_plus_80(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.02;-0.02;50;0.5;-10;-0.0008;-6;-0.1;-0.4;-6;-0.1;-0.4;25;-3000;-55;4e-06;4e-06;2500;0.25;0];
x1_step1.gain = [33.3333333333333;33.3333333333333;0.008;0.4;0.0769230769230769;833.333333333333;0.111111111111111;6.66666666666667;1.92307692307692;0.111111111111111;6.66666666666667;1.92307692307692;0.00135593220338983;0.000256410256410256;0.013986013986014;1253.1328320802;1253.1328320802;2.28571428571429e-05;0.0666666666666667;0.0078125];
x1_step1.ymin = -1;

% Layer 1
b1 = [10.194461749809615725;7.9526263053766808042;9.4672892128012655633;1.0330290304317215622;3.7773336997890063493;-9.08253077816090304;1.4052104045691879985;-2.1128705469780713067;-15.613157820524692809;0.8342009155334988435;-9.5222381476953419366;-1.6615935692809187252;-1.2125076737373223779;0.9479105721248877181;-0.28237723037770356971;0.69424116227292465009;-0.59536037482513670671;1.062846584628311275;-0.80340597612530573191;-6.1445830062736410682;-5.7703475759267135459;3.4836529175933290681;2.2613279763382529985;2.3523230278715456798;-11.990351008200619276;-10.676793887990784881;-2.6863567902951719368;-4.7669646146984216983;5.4370164309643467249;0.18675217466380855669;-0.068825798513116154265;-3.5416817728788019259;4.156243358333598259;-0.7036437027046668069;2.809736134590706591;-9.0725455094840175008;-2.2564068236736152251;-5.1147874148879699518;-8.0735035467800990716;-8.6284620701305492219;-0.96534461837713891885;-0.33247268369640109453;-1.4231616057603100334;4.1358236763755087395;-0.95638564727749952876;-0.73336387102248934422;-5.9702706729744141612;-5.4487644983701937207;7.2881650709407450606;-0.14683412503010420669;-8.1580591641901190059;-0.87782923848917082665;-3.3148189236136347269;10.539627722200155091;0.89545324466725861878;2.7735388482595677573;-3.2043583691820241022;-8.825914595630125703;-6.9624070891333396105;-0.86938664433044088309;-0.30490696797233052262;-0.70672066093782659468;9.9779666609592982951;-2.164942935078838282;-0.7364579869902923015;-6.2766459075583256322;3.144000746500477117;4.2317554705851341268;-5.7303975417923371793;4.3381697759387840563;-1.3578038563329439814;-1.7920707550031489408;-0.55609346967387462968;-1.6748402475632733211;-6.171272666543661245;-3.1744187981406910559;3.9656453354803113953;2.4582954282659246203;-1.4533374400699248241;-7.8528294397674960337];
IW1_1 = [-4.3405050239079399077 0.64088938015881569132 19.032505516984425498 -6.2412348118287752641 -7.2440790202769926864 0.0013540379072063766369 9.2525539580413944662 -0.86256434408527205004 0.7224348561307120109 2.3246643090509233609 -1.3022291824121450254 -3.4858850942987911203 -4.0847183525434047624 4.3229051511304481537 7.2951677346043277694 1.1957801416719771037 0.87099768197143045967 -16.425656608063960107 5.9279863912503740764 -0.35608076915134445617;0.24168520866325171603 0.13988167959700370524 -0.23765997641666480877 -0.96411085139538132971 -2.815418027032592807 -0.24487870449985449373 -0.019543854857472214154 0.84140510695171166766 -0.35546903373529747938 1.0677323685544151122 0.81260052413941508132 -0.22201726756241743632 2.4159620814259845645 1.7228690454345620964 4.3819578895726909451 0.3510122776471668038 0.036676720845406775295 -0.0069857201474279864359 0.76092276177294593253 0.34712627176154448039;-1.5216293339812585472 0.26713507970963873417 -0.18886715418838170844 -2.2497036873242786115 -7.8523355686774838347 -0.16639954707704177062 0.0011392934216180737768 -0.052786293782211654579 1.9756538990368854858 0.85822995026255299855 1.658879841271869493 1.0251075632953392525 1.2948290040926595523 2.8761645771372448266 2.1932325277554949317 0.15859595519772692884 2.6172550629279283108 -0.88465418979658438925 1.4209614941225854334 1.2018813714484262167;0.44679008388758695292 0.21474451256160120849 0.19024554414055180884 0.4418948336535410415 -0.22716905328049324941 -0.034554980933460002768 0.021733289706235590227 0.24159069114645478904 0.52841668288185739133 -0.16431340750787148952 -0.078254991464292072978 0.12113885651285953571 -0.082493838793261567433 0.29978844849843122589 0.58343487462651488773 -0.2337251070110991924 -0.090039086573912907596 -0.10841164353278741339 -0.2657069720575389038 1.0626528788519762347;-0.47083432801939184564 0.020749097467570334213 0.3141435371439346147 -0.0081720800772002166745 0.63087004808073654516 -0.35315928885097436218 -0.4241965850426697715 0.2111098647785250304 -1.0376499889427073242 -0.23880128111901177679 -0.18456603227209453233 0.32261517870394296192 0.86007839220369564082 0.20388501186138491272 2.624157384813177174 0.044380019954878634214 0.13116017556676035083 0.20108841367772195552 0.90499078633562468621 -0.020133681117271262639;-4.3192308079560106648 -15.699642347484166649 -13.573881928270756347 2.4889185928573205331 5.8342048902530558863 1.5375845428535304116 -2.8171477034435263853 4.6604163995341210125 4.0293664097862551543 -9.4068657800766857235 12.2001058006670835 20.669797343110321464 6.1233433475780660871 1.8616299296912557359 1.9360051293572497766 -0.64042203343471026944 -2.1617192992177294286 7.1032422778627539728 -1.9196685594718292389 -1.3251193230752456031;-0.055871160122523078062 -0.20358295159761824467 2.1733431098939521853 0.54158915377206484632 -0.22983400807663856291 -0.040084572731330966877 0.56618453568522264518 -0.28441625995523567294 -0.25142997637283626133 0.42273654334691623813 0.22262398715203915445 0.10965246128417960314 -1.1373817799834580189 0.86266733195035039117 0.22593287725035265945 -0.021195165247845013795 -0.079226377539109341108 -1.3074362178226932585 -0.0026023793669151351442 0.95097689842538668525;-0.40180517453327296851 -0.33211871999907538466 0.65034355993290471343 0.84092689659152297654 0.065225709406532383916 0.34076425837513579786 0.54751699125703712223 0.171930745063094359 -0.69054730221503313192 0.25958198454558562007 0.052893574988479637178 0.54849162080573843348 -0.77695058702722674671 0.64884110918269644053 -0.59896039466128425666 -0.45250762508251901606 0.1552831416734998804 -0.39454868843903123654 -0.33380327639518841965 -2.1735614099226672202;2.9967674852605075131 0.5706530208434821283 5.323334846307340662 7.3251831850148612091 12.882044191770154029 -0.21534033134112628982 11.221723170810371073 11.320745363780876147 0.29182688474023504854 0.47213015774447064654 1.0762003890163773789 2.0186981115763988903 -4.9514722583224486385 6.1014883524993308583 5.9350281126155675082 -8.0051090011857848339 -1.0377082648949105259 -3.8691616016965211244 -6.627963865664432852 -3.6371001022466327157;-0.17557522136648762157 -0.1975375640935833621 0.18781463255350477892 0.14058634597769387176 0.21683115486458573451 0.10297901093050275401 0.10930914070876944499 0.029654795321931784469 0.1319764369376768276 0.057859413297310792468 -0.014409003154786487536 -0.65288036844653873914 -0.054891933958667996074 0.51868904008205896083 0.3075387563260538748 0.058551072660284093907 0.048923930997071686522 -0.058046778141673117946 -0.051923030300741787602 0.38566271606944813044;-3.8574064529743821161 -15.506884779580348166 -14.199139049426092285 2.6988913547863595532 6.398604541977078064 1.4951126525046170013 -2.7371025039844121274 4.4481967570925107225 3.6780742646211797009 -9.2409026694272498048 12.047286003036484558 20.343408714836204609 6.6266940329326970982 2.378131048012765536 1.5820652643102444124 -0.68439613650520814137 -2.108100368444835393 7.061164263819629916 -2.0711393929327770458 -1.4565012122526874716;3.2149702423907871029 -0.65644416878351485867 2.9616573508361496714 -0.1486530589092258936 -0.55378018477081714099 0.06841833528457597069 1.6851433900638532748 -0.53702068456024720788 2.0568522591680498124 0.19666387539910998306 0.67987696579535050745 1.1748582886141296644 -0.14416021837706011199 1.2047437370005957824 8.4607415852817506874 -1.9107172968534218427 -0.12213183681454969909 -2.1082460369080355811 -1.0788318532933056648 1.5831054739532062214;0.26384395567810281502 -0.12617822699507008632 0.51136241895558343096 -0.10253184653736688303 -0.46149414515997233543 -0.041243832888037887385 -0.87240457985272357178 -0.41292114321022327372 0.44843636731658537142 -0.043543427908642552693 0.02903579782783842142 0.17073731366418015698 -0.12323971791151670796 -1.9540545647591980316 -0.052784179838133028773 0.10043342107507137462 0.014318555841556699498 -0.11253505797766288898 -0.049314733646707860359 -2.0272736758910427923;-1.6749175230011481563 0.23711975047665176386 -2.2440288030481427839 -2.3886042487598304618 -1.5818623202896153757 -0.49595063130769145854 10.66255567944843996 -1.164226842942681861 7.8953536962526529308 0.059093920402215102672 -0.056925431110246040023 0.14652832335403162545 1.8508643634198771455 19.068145333908169903 1.9173067515973416519 -0.013841562201761548404 -0.012682961984856615939 -2.9815507666335894221 2.0421942267815613725 0.10032441933600989847;0.632102493575064317 -1.3719107151747684803 -0.95620869021769228091 1.7057860685900239073 1.9260084341272734054 1.4580455719945903947 0.61066424286954423817 -0.95413097782242350942 1.8484737846195125055 1.0044492273688527817 1.3516775080348895077 4.7580402407812041332 -0.68941495246444595146 -2.5085889382942410109 -2.1866076642035348065 -0.020411312843223814589 -0.69141526859162016905 1.4543095672644186234 -0.26557662969882672721 -1.230243701481361418;0.26078913750180515718 -0.17994249246670732112 0.10302450515597834368 -0.14977050841103028977 0.53179510694553877581 0.0063909300550607141961 0.0060137450544805043373 -0.052807382459337179337 0.024889924065816897841 0.080331927376204453894 0.0043624420107518597015 -0.15054093351168890136 -0.004025068059102960942 -0.12100004543531116263 0.071119415577012276564 0.024476690689694109715 -0.0061857371639848120204 -0.039289197113692581054 0.099293696751042867521 0.016387163906701186084;-0.055621416586951633043 -0.42204011815802550123 -0.42072462380154274086 -0.11294450919856244275 -0.1417755069844846838 0.10429607601103146886 0.027606362996397511983 -0.096990248264487488594 -0.2613502303101964408 0.25982108615252985651 0.13051353342718555184 0.096629139669148669811 0.17107496060900570511 -0.39535278595732781248 -0.54814494348194064965 0.092977704051032741828 0.057328449371864244333 0.22573548086418640524 -0.003869696551762544668 -1.0108400634161831544;-0.15955221006072653478 -0.0071531348531492329121 0.2652682854771024612 0.31278535192383188912 -0.59620224240722596853 -0.11377761157507433609 0.22057626304777860904 0.043376543542005742415 0.67369515858502870831 0.022699046035093470297 -0.072641863354221097859 0.011537008931351747099 -0.050092553743456579018 0.40282698845877146221 0.85576494190572371945 0.083550955744038452044 0.092559258495518173526 -0.10808854691401212356 -0.078825871858244578316 0.22233511731012639556;-0.31255074299948337746 -0.26030844205118641721 -0.04013321904016947661 -0.36559173702125269401 0.21924114333437730306 0.043678133453333906067 -0.0096801593637991841662 -0.16621117041715502416 -0.46723037481919199587 0.19676966219228236854 0.10562211767175683219 -0.080266397321949262134 0.039616059721171215102 -0.2793004581224859395 -0.41305287258436446107 0.1772242119041630426 0.072586329440552155301 0.022899489266234952789 0.23575652525395890402 -0.99098286396709978074;0.38303103515689684855 -0.0079357603040470011541 0.098479833406664288309 1.3679097799608592734 3.5733402434991554664 0.1764400800365838462 0.12924131104131325598 0.39583131689669887043 -0.1436352861411261117 0.049225174453663429752 0.18917531221676819886 -0.033315676495793290768 -1.5898016064771214317 -1.3205220482357857836 -4.4926075246177807898 -0.37322899991462815672 -0.047189257218997061882 0.14288089440704260236 -1.3185394879228959919 -0.68143369465591174805;-1.9717710208825194318 -2.3092561599712806419 1.600810013589485381 3.0127955632427041444 5.2528729152520519108 5.1258500197980945146 -2.8827687494847222816 -0.09254309778543760856 -3.7571492032595577015 -5.8590593778917252621 -1.9291426052721962758 -2.8012395357512693828 -1.0522014467081326483 1.1665184274716275947 -0.49724619559367461141 2.4928688016995477206 -1.5565769272376774879 -0.74443544294244468063 -2.010645397342214924 -0.52768320976612714812;-1.1356910933082673409 -0.42380624156173762884 -2.5921391316610042921 -2.6377154892017471433 -3.4631720815852853335 -0.077850647102633910301 -0.37408022804927704152 -1.2467347284623264692 0.86510249650034554136 0.15277653913799310592 0.21900857045941662937 -0.26670614050768115533 0.47137169026366460001 -1.571726473751185571 -0.074511240687899132906 0.3599878525574562449 0.1728853111902920181 1.5286854190743450754 1.5403569927520168736 0.81289035906961903954;-2.4402725684347448265 4.0464949291577898549 -4.5896201704113366304 -2.7063792819401069067 -7.6633647316781789982 -1.6453381705168388383 -12.318975020585559932 8.0301994993706973247 -13.90029312674858275 -4.2382868104123652131 4.2001725861508942828 -7.4137743906022253171 5.9846783244962464821 -6.6429756076910999596 -4.4282347781147883836 -0.43929610148729164587 0.27116430417286024879 -0.60690375328231460639 -3.4376185526799005743 -1.2380396231791024331;1.2133096277691308718 0.95355674234227805197 -2.3980068647899726031 -1.2967516231649733882 -2.4170848103203272927 -0.21060710181417802156 -2.3965633722342767342 -2.7224764518611008768 0.35102939881253447663 -0.48914844710035215725 -0.39589863297415267551 -1.3339896888079936232 -0.028110455801449548557 -4.2611596383551004763 -3.5912763027005825123 0.015910787675334922553 0.11687714816343611202 2.7160399823510039674 1.190335602190127684 1.1488071651359146319;6.6584077233933474105 2.009979574880077724 -1.2035619681403482151 -4.6722227747676665643 15.514552230295681312 -1.8233981599379476268 9.218486267524115263 -0.15523007367231678177 -4.2632715699843322099 -0.77581735366747073268 -0.69037571933484198627 -1.9457465432234164471 3.0646120822615894319 17.078434569570145385 7.2097700111534681611 -1.1482268957682348898 0.18169109720353612825 -3.3982578011346480373 2.1137050614343451116 -7.8868542545634436891;1.9227610825807797124 1.0538050606523987618 3.4220204973792478498 4.3196292003767418066 3.8686150671061159123 1.1003227458977111741 -1.6810386353177499963 -0.25225552710004384149 -3.9872915243993172218 -1.2143715184742769342 -0.70997294301511804093 -0.40027225140313410501 -5.0632666781214945573 -6.41599836815951452 -0.72788876510495537087 -1.8862908027979969905 -0.21818076960534479869 -3.8203826178769033639 -3.0404693262714963531 0.7348045700542916725;1.7580222829545266716 0.37924913974458801524 0.99326035874833207284 -2.9006559136134293375 4.1544833139697505686 -0.49478034637651946426 0.15210373139686753086 1.370094459141345089 -1.3530346586694697031 0.63308714155787204625 0.27504319066765470225 0.51249698593217074549 0.33023262909125111753 0.46666788739167830435 0.20978258944469174718 -0.71008674447375219607 -0.47529117599721742993 -1.0318882267013378407 2.170330233475008086 -0.75277172233809264146;-0.17983123935352721134 -0.60895610273502887022 -2.8191179763247817824 -2.2530339402125081349 5.9408385756670654132 -0.063674361700902903927 5.0872598785246792019 1.6459759606560810941 -0.74886641459537750531 -0.13469780438454978522 4.296479621650755476 0.35977060487803963484 2.0823425824165893161 6.8540968199038330155 3.8137147493512633112 -0.44736222492344390744 -0.44499224021718120081 -0.69264302259613996782 -1.0382037827091536997 -5.3252035199965774837;-1.7184415706142084357 -1.0549916821685734192 -2.1541525240085910298 -6.2724109673908721163 -4.3356861231219117059 0.3677171241952457148 3.8996630060477111002 -1.9231587151074167608 6.1001874601522860786 0.58409678479486759617 0.11100467834705443626 -0.1145297434333239911 1.4449169193117843424 2.6477609621795954453 1.4182281196042738625 0.62705112555593989221 0.32613141415864216333 0.012675090381993150621 5.6694182270229189768 1.2816302912363819466;0.13720183089272613985 2.0834463485030680907 1.18329106282608576 -0.88201101544202020754 -2.8369696840569260665 -0.36597223062033185093 4.0702106108505109461 4.5074563244610477142 -0.48727709485403836176 -1.2871285612468881254 -0.46254672623571990719 2.2547915945730681031 -1.8700258631142516741 5.3018278160733878224 3.3912734566379043599 -1.4204636736636457872 -0.39675902664817658261 0.043991220135055401907 1.5851012834484041747 1.0649795225813141197;0.3956627954331170538 0.08360987675282635645 0.16056208134572477753 0.44713198187436770104 -0.61051554604733127007 0.14074844488242732599 -0.17412480749598890917 0.19393144663453540377 0.25737310959587822445 0.14762038156690129864 0.090688443812438665481 0.62088107906444545137 -0.039876850142249238573 -0.017751022554773825818 0.3169001180974383991 -0.1523736555593843689 -0.13669306490265825671 -0.018965121756521593349 -0.31085705325109003194 -0.15996263508631158867;0.034232552878979256861 -0.73330873341963076495 0.56239558729816974125 -4.2500129429885884491 5.8039442838229469146 0.21192438664714730034 3.998777522720656119 6.2406970150807383746 0.98516406497875985693 0.57422128136464167802 0.25176925851179277061 1.0850082392222197836 -0.96377685852026129254 2.6685878389150401446 1.3058331754657022117 -1.1174341631113324791 -0.092285003849494132155 -1.1253452531865633102 3.9380335698322301852 -2.0130106199682780144;5.9842752643551193614 -0.28767524259709714718 -3.9879540926955807656 -2.0626949971129580064 -3.7633669040343864509 -0.43776101782589460498 -9.8393074505862490042 -7.0864373917926704038 -4.0716826120041123005 0.19370428944714127018 -0.43282723642960785337 -1.1233273851187246528 1.3552337620140284535 -4.5063083711560585343 -6.5167484672164528448 2.7603258599504294502 0.5596072785016943385 4.1490887375804108572 2.3964301759778128265 1.6885674302738029606;2.5041866885855283975 1.9734200410539852744 -2.1261556341415315252 -1.8399607288625878798 -0.64587290569057409506 -0.41550859585119004347 -3.1229550790060383036 -4.3708724170032571266 -1.0018259234030719718 -1.0254456740353339317 -1.0533682191507609538 -1.6643853250906284202 -0.95882488819865974161 -2.9245985381936758785 -4.0938309019714465009 0.34851458959472159105 0.12313735173686218838 2.8388385687946673386 2.1113976272109296062 -1.3058365909238029978;0.31240267643752916982 -0.57426030201187561186 -2.6280550559561968171 0.49877662508051062717 -2.7838256087209058975 0.091986686252492899651 -1.7525357828413514749 -0.45007166088325623043 0.047662614772130268426 -0.21509329587239611747 0.48773539735942605944 -0.48110523037106284194 1.430937536616312622 -1.3176150061291564963 -0.93634112355144982764 0.43362954987415980312 0.33883802918587679898 1.0313680350562210997 -1.3175090097890069796 -0.07273260411238363643;4.3288623462724791224 0.93768092092940857896 -0.22752646672479537315 2.0770974924489560287 0.13259260486656346267 -0.51108744284495621901 -0.81765048953821994893 -1.4142090967026719195 2.1770002087855480077 -0.55837380546540327231 0.25361830984296007685 0.2532081137937147175 -2.075636469937138795 6.5666005232741442299 1.6630585117406593287 -1.2544783655811853063 -0.33491721643374583461 -1.611044394643700528 -2.3926776621350085428 14.165630612202813055;-0.25708559956885174147 -0.0030017773710245081696 0.47042734395583069018 0.33205041424165065989 0.36709199099101097463 0.15511641380566165704 -0.1612451430734775093 -0.4286272070585507854 -1.8318856420530338358 -0.27144282169133104876 -0.24267253869157473511 0.2135527901836539455 -0.0098474117826952093507 -0.20608825070056882578 -0.28960809047718061304 -0.98376857047026478043 0.056298045741301976086 -0.25282219965287844321 -0.012654045122950924665 0.43729583000149380156;4.1334488565492382151 -0.41018786377637150853 -1.477107510983773242 3.6414640034587808515 3.7385648513619047506 -0.044458859718072618605 0.27623795871684964087 0.53611337273794734681 -2.174085340547422085 0.13621900143477794209 0.37258914748817456575 1.1418213469658140546 -0.55747586436635432339 0.71213835775118039528 1.4973054721926484234 -1.6463027081155441333 -0.24497223437281553937 1.4545379085167151612 -3.1125619061887035421 -0.40840294799393311864;-0.90866447999382071732 -0.015622760386784310602 0.91747404882104754975 0.17444513195181649001 2.9109108007488311287 0.95052902819666806877 -0.29101797923047550976 -0.090916295050712900294 0.078582582930261171694 -7.7521941242770404656 -0.11533277106639085174 -7.0448264080321720826 -0.23532062901416272993 3.0497578773857911827 -0.83990364216767154915 0.42876722941094630448 -0.71044705456764056795 -1.2170699243293345848 0.24282912691673105843 -0.65695699113802075164;9.868167626765799838 -0.68326675515259127636 1.6016724775707542605 -2.2979093897078040065 10.393509848674503004 0.13797533490106692056 0.82147251601140047761 -0.58764684182539428381 -2.2335847023784891618 0.53940780403042321023 0.16272193331200079935 0.76000972243676201412 -0.98948157165624817111 2.6548013277114876907 -1.246603945274117109 -2.462160867010997567 -0.007102682937547075484 -1.6767466935630375158 4.3448438783424796483 -3.2036682532601026274;-0.082858451329301724408 -0.28335604299366018433 0.37320898780304856412 -0.36086872570413852657 0.82821421241679549219 -0.1893603108773666277 -0.20356477888331767079 -0.32224554721527226553 0.16887715354020749192 0.029194640189701283328 0.13757683547235702304 0.016595903499287880528 -0.20092352158349913172 -0.79743734122816956056 -1.0922185967208513091 0.1490962059535109463 0.03356793244398001419 -0.34110653918123118311 -0.079427123766091276003 -0.058238114778802155258;-0.31729306783674454673 0.66295378072959842974 0.8823743414810574226 3.4621326549381339355 -1.9909984140548633302 -0.00044189909743618351664 -0.34109104363135217541 -0.0031194101151376511273 -0.81947847701593068415 -0.23605060637298785897 0.39315871648886530076 1.1781341445521495981 -1.0049525759242219358 2.0894012761183429205 3.0128465264272570323 0.61119477414246714542 -0.41299879778522319285 -0.20410246740602694393 -2.4016415209898549499 0.502791495854323367;4.2972102744813911457 -1.6335822842923506393 -0.58885128005998832457 0.044043622088098435818 4.7660306050979812653 0.82314381140409742521 6.0510287402722973127 -2.6349724032446415478 3.4876650789829777288 1.0223937487491481235 0.59655081368932372232 1.804992976474603994 1.6543031924789108889 12.13647027824721647 0.39741100493332015553 -0.21321916381907923821 -0.17098923031650908877 -1.7504168703841602728 0.94793256244408019562 -1.7536543610971384588;5.7914585404033687155 -0.35284420165159380289 -3.9629070797666763326 -2.0420109687784004926 -3.716120060661514124 -0.41142538428872110767 -9.7585911733514976163 -7.1069011156204320301 -3.9032413537473327203 0.20921597720421375444 -0.4229466147267363918 -1.0880497012621006547 1.3390137139335562821 -4.4423371830106566094 -6.5529340784918694851 2.831401410563316734 0.57359447374504224371 4.1173320202223360198 2.400996029034059287 1.6245991171071192394;0.62827112131868212419 -0.90545098906440080189 -0.098023644001792892277 0.45344431202378432388 1.2313341061682290256 -0.11870014661519762145 0.031607888363637925977 -0.43008720661824018094 -0.52865351454062403658 0.41448733728061121218 0.26015771316755431641 -0.59907144455444716336 -0.42451622061380828166 -0.1461140713427466209 -0.81809097410717290799 -0.13212047504177537594 -0.069099320446651249505 0.16721355222591766099 -0.10150107395201442284 0.26603655857902175352;-0.005869228695019979708 0.17796378048796371307 -0.12196297811175271786 -0.12524324502923914193 0.12070838727242497179 -0.051748065200388174145 -0.054071317853897030159 0.0016100485549898112606 -0.16380082474658252956 -0.051787804173857726608 0.08117084265640163443 0.25468024738065347945 0.0012730600319598881984 -0.2053908040287533987 -0.16417837464674592263 -0.011596435754698805609 -0.028327669243628079282 0.03275115499212073733 -0.016064055396105701018 -0.42708732629555690163;-1.6101030466373180694 -1.9888196299836553571 1.4936558564257935711 2.9279747036158099149 5.2156804830492093927 4.7165445507188819008 -2.7859784794729445245 -0.037438172904953617715 -3.7054427423585782897 -5.8021169501339322494 -1.8718695560561986468 -2.7525295396953874949 -1.028430016037295891 1.2212348323469006672 -0.49951963916957559109 2.283802387867328143 -1.5645626951117159731 -0.69570082561513379993 -1.9695146320173555488 -0.56571306284528632968;3.2406488881554831316 0.38229526793245643956 4.8266542819181070811 5.243698129355702342 -2.2084295793258639229 -0.2325600088843735036 4.9200464351258794693 1.7790729886975928942 1.7622126010241634386 0.22005084865320398424 0.49876440462317633839 1.3937935993777033072 -2.539718517242767426 2.7176313166645948982 17.097665453671577751 -3.6589752129694921301 -0.55542943861196236721 -3.0211543071894015888 -6.3898794529530080766 1.8917563407771256223;-3.5115582698983223153 0.13524825388657121805 -4.2068705415752285504 -5.4240044977803192339 -0.56517557860552214422 0.56582146261560872791 -0.58895730264538559418 -0.36751893621912434806 1.3233454027426978517 -0.11590190278938393431 -0.3798935063733879236 0.067664707704732901528 2.2693420169579652246 1.405052729094068642 2.5803305438064918498 1.9002042334634723364 0.031869036592205031433 2.2209879297216463812 2.86190124030863835 -16.860210830818807892;-0.24106631676822376509 0.065752728005135999134 -0.17180305664935871524 0.13485169817260209135 -0.29144354070115541244 -0.03992588008523093035 0.0020886268547352692185 0.01527392519974518463 0.12032385701241599119 -0.060804161526462813248 -0.027998587988988448555 0.028570344335650851852 0.038238760017906776867 0.075070118416955988749 -0.16421086679554230958 -0.0051865032241832044121 0.029165331009273372936 0.093909373988716890458 -0.011119450467907321736 0.12559988484873782499;-0.87146923212031879302 -0.26385320704375436751 0.99761047666479552021 0.1961636743584900533 3.1338340282842249707 0.93944256554558247529 -0.29497665506143633252 -0.092342818798783851686 0.067363817547302140554 -7.5458098915491227388 -0.065056182203688459054 -6.7713635714154865042 -0.23846136400583661796 2.9369091892685492695 -0.86140516304568326422 0.41938016759788293575 -0.72279559653107694484 -1.2386000822286293843 0.23646361630580722824 -0.71759313423355119976;-0.29484952513703149846 -1.5609466785544867662 -0.88638885370837938726 0.0025047821065012974666 0.9610972853725503473 0.41175509999446252563 -0.51469372536987134659 -1.1695950027560770845 -0.21209423545982100667 0.94677754562567739693 -0.21068213595979770614 -1.9824989928671084005 -0.069663294718415105788 -0.25077756353864005812 -2.6591330563277155719 0.49567806649227236226 0.54136222115247834008 0.63762604377453779847 0.28166635195539191372 -0.69685266007674295796;1.0182979079753757823 0.40091150246537077262 2.6937615224692654792 2.7104527906482944744 2.9146897742166180123 0.091109428548148699289 0.47621800151618337571 1.3675542125744624133 -0.80543958439710572339 -0.1222426919257646738 -0.20572693173544992495 0.30183542837154730964 -0.45469586452452143144 1.7473878706749355061 0.36588691734346551199 -0.39192977216638497096 -0.18509061017665404125 -1.6288585140136204732 -1.6762930334109904518 -0.64883609631690786212;2.0259302978031121789 -2.6285267379137282617 -3.4927053972458135256 -4.1670667825686447117 -2.6511268598198833857 0.83380074974758766615 -0.26813319465439566791 -0.21453107281935723805 -5.7383861412028016602 0.026836831591177865569 -0.36897489809304706565 2.9489706842918304019 2.7486065020289967009 -1.9234889288248986361 -1.4847466921485028557 1.832207602151019632 0.20150931748629674622 2.4553651186127152251 3.1116074710055006136 -14.524669897756202985;0.10273370933785068437 -0.33741815305330424835 -0.4924731600837304879 -1.1253542049874873943 1.3482796906139298265 0.18923221000866552455 -0.29210822338967667999 0.057568324923530658777 -0.36531479952479789519 0.17719588291160939808 -0.064973787378760111677 -0.16269194050228960591 0.50667476942430045295 -1.2551598055889618966 -0.77553125567529956896 0.1056382635611156362 0.12266218632614442341 0.33750892204499027827 0.33204154993753254299 -0.70512594528507899216;0.29649909737231755491 -0.587886027329474814 -2.5291509484562584298 0.63252829594234760702 -2.7492920181418365466 0.10452918252069827443 -1.7833481033087961176 -0.45765594909694590209 0.054084050017304818869 -0.21699525634637961691 0.48956017135582458044 -0.47743613181712535321 1.3578324774798502528 -1.4024910884560048974 -0.95504962014816863203 0.45449610034947990345 0.33948861570070726357 1.0091091490303127909 -1.3848741164580093965 -0.061789951565965735292;4.4409979213969794642 -1.3680674945192219383 3.8576083433577355031 1.5951863001842991885 5.7077158959199332244 0.30660491508238524316 -3.2268249568658662341 -2.0207687098956634841 6.4498685586379584933 1.4371340876899305616 0.54735304114344307536 1.6097563608621516806 -1.703641045319795877 -1.070533744869545556 -2.5308094768660698293 0.40811269928038068633 -0.16058669482047543964 -1.5307028954138375276 1.4104140196657564132 -2.2127880519879652432;5.0031719788742003985 -1.3482846227611704482 5.9176624146509144708 3.725624726747206239 10.334838011659753576 0.99101067501196338227 3.563012138268620177 7.8463873980113794104 -3.1410221460039080554 0.35943383437690967774 0.44251352106845143197 2.9810795833774301755 -2.8405649841416380497 1.4707627966743761494 5.6267143955846892212 -2.8123690058856412044 -0.36507144067916696972 -3.9339569825049003349 -3.4941846770128139887 -0.67826834911431244102;4.6920840357672517484 1.7012739310205231558 -3.1716896571198791577 1.0990198088580620528 0.78592236296709172549 0.062137266128216919747 5.383788567551105686 0.086844040570238964505 -0.70050274426171021958 -1.2821941830115788363 -0.051312026783711869871 2.4981794327914079723 -0.72170735714325895405 -1.2032493342035242012 0.106516844783636766 -7.2057659923704324711 -1.2686065275428588528 2.08947881959596371 0.67181613675972351452 2.5785616282002052913;-0.19068804727894725359 -0.33936537338331029812 -0.018239562014341254709 0.14626487833738835431 1.8897159564153931388 0.46857072770467328438 -0.96260651111573047878 -0.39277180356761542956 -1.8948127149155751248 0.070534002132661380302 -0.25447457016726177104 -0.49921392074236620173 0.036804249444858973261 -1.8038064600857635078 -1.4952106625433345677 -0.74934769764765696287 0.2264149395187166347 0.24579296939592376603 -0.42826607230160723683 -0.98486237087244188348;0.59065716908546705977 -0.12882683624813806578 -0.60827691841323616728 -0.8600270073692741768 -0.41317076928741663933 0.034015133439273453897 -0.4592877038554150082 -0.52735487009479331544 0.48533853072748867064 -0.14285679560798025811 0.13797362382924746593 -0.17331005035564958638 0.28402578163205444151 -0.91956856793177133014 0.12101638488257521198 -0.062300484518568538528 0.085565873542380849193 0.18859238299952618689 0.41090528939698894861 -0.26469566602827732105;1.0720264064047044794 -0.94878196760279731592 2.363781081872152523 1.1867766682090654662 10.155020890658477128 -0.47204638123475811673 1.4359069406374529443 -2.23439154018914099 5.6112119164864102672 1.421133581430295223 -0.12491735006321773305 2.4460174559953351547 -1.1180166474299935153 2.4701955080865203307 -11.106477253357248003 2.9528830992982464387 -0.24598857148080471857 -1.4015688464826525639 2.7948744501083964131 2.2090059004485493865;3.4007790382785918482 15.314391145252743698 14.828102398340435641 -2.9103495486393624603 -6.9840867194812394914 -1.4531322762875298338 2.6608364571244362828 -4.2430649958823600798 -3.3304541082093370719 9.0811273699417061067 -11.899535649500700529 -20.028751581704504758 -7.1233076807709609923 -2.8753808660282400567 -1.2358320311984649642 0.72919665488912077667 2.0588764068361471438 -7.0338805471820053938 2.2201009311719839268 1.5914458857647684198;-0.31631165302478853052 0.12637377797476087582 -0.08805990521468301524 -0.44851578639073680366 -1.6274957911440093294 -0.15723540408689012926 0.20609807119246248419 0.041162726751518850798 -0.30283692121699362643 -0.053388267623574604814 -0.092385734573808622749 -0.11579873048606117991 0.26848370254794262646 1.5168714246851040528 0.88642785424298464747 -0.021466165773073964812 0.026831347408173868152 0.1425434510208684058 0.35084120972103666203 -1.3928717297973833844;2.586772702748285635 2.018359527820142052 -2.1193852455146355851 -1.9383189042792852153 -0.66082005768857421391 -0.42571341508116705699 -3.1651285811031217854 -4.4615543913076862736 -1.0779786543485503358 -1.036227601380942609 -1.086190048426156407 -1.7158303395951075565 -0.96244267620000367724 -2.9486339781861072851 -4.0543491277665326677 0.35466109257144051714 0.12751343991919020238 2.8383843319246921943 2.1862826214352999443 -1.3290602773744875087;4.2249345049270843333 1.3707884036959314678 -0.38902146925337227623 3.445167431311105144 -6.4040894944324451288 -0.72598441974641769736 -1.9547423906308702968 -2.5054016318473255609 3.4391380265669591054 -0.5218124699897700447 0.44428260511516987075 -0.13645509801074609535 -2.496034688604348073 9.4161880481755737549 0.79573331112241518781 -0.83959002516623804091 -0.45324403215909248033 -2.0412202302298516621 -2.9771515640367902655 19.582909761524117442;1.1098364400919773498 -0.84773928468387138579 0.52566200208569557883 1.7841242975280313665 -2.422552275271040223 0.33847442229649421508 0.32211327329245514894 -1.6028045409216324924 1.0867457933888908794 0.90315335411640040864 0.50429268334008992003 0.85762066421789662218 -0.23690302584697389698 2.7135828777787596167 4.9297997183380601882 0.057279027209563578016 -0.23356806794531936866 -0.10164968530920952261 -0.19946375073935346256 1.9729059536532786989;6.1884706244600637959 -0.21892273098005116116 -4.0544451920406743284 -2.0942867804376450458 -3.8830692614029387322 -0.46802447460090135234 -9.9628089489354074715 -7.1031937224539838382 -4.2484432275483232644 0.17744053810002458071 -0.4450883650441450623 -1.1684465881876686666 1.3839897034035748558 -4.5682429444021073195 -6.5160140193236211203 2.7092780508461786759 0.54808794076608935431 4.209469182709812074 2.4015897686484555251 1.7754761568536332472;1.519454007653444183 1.0838936765428575093 2.0414091688184448081 6.4329623773656443575 4.2975962512850145458 -0.40357697684949883632 -3.6268222482452472377 2.0306115716537305182 -5.9966468271740236418 -0.66535849619518117049 -0.13674486558953563575 -0.059877740294894322981 -1.4197379643151846196 -3.310206506489215883 -1.0214026830532643153 -0.51569935673772215878 -0.32919739353430987894 -0.030006167482195440083 -5.7487395912425176547 -1.6825666263210183882;-3.5539414295744893302 0.32685357464283870677 0.33365276774170821161 -1.089894379841372718 -4.7141072616363137726 0.042700789179840811793 -0.11787595954624570382 -0.67151888568648776534 1.5747930671673575631 -0.18193343624020161253 -0.44726413826532823714 -0.64564694460807126042 0.2315451587174794934 1.0801103547896724333 -0.24473168885138776862 1.7392007393228392509 0.16635915173020021651 -0.74782644408010956472 0.96794331237847286431 0.63048550640157630109;4.2581227354502857452 -1.6380540059705344103 -0.60659846008834872322 0.038602324397945371459 4.7006848449088733943 0.82397879399934070843 6.0892125948662414459 -2.6521919348512015269 3.550393966105194643 1.0237934719305887832 0.59690967708479902853 1.8109232333269327242 1.6648979817426738936 12.190451924058143263 0.35533512661272625976 -0.20016816021458697095 -0.17042044485528312636 -1.75338132302780636 0.95975165126414518912 -1.7181903756840095632;0.0037813288331228038508 -0.017219915192017321015 3.08241134835610886 2.0576203941883255411 -0.52963846188964469608 0.077143735965048504388 0.76655926874825841555 0.90396019547375139336 -0.87267133625485004966 0.28894035888548386115 -0.2412352493074306492 0.59915399560932669498 -2.1927751732198790258 2.5964489476516980915 1.8245898051726818778 -0.088951848563723595609 -0.24275476435603438041 -1.7205874799181211099 -0.83801550471597507919 0.62603377827498718489;-0.099581236163590949872 -0.43696514285561427471 -0.54613204070225351838 0.023383603861735428875 -0.1479772086012927923 0.12562249456518209678 0.0447672817077960708 -0.059292998990919131008 -0.16403972873405614497 0.2615725835828273671 0.15452138030318574025 0.093312841666896434445 0.14164539147872964864 -0.34575065488823619742 -0.60587517567996385104 0.094727543381427858904 0.05316064851313491435 0.31742407972292197016 -0.10466691635256929194 -0.97889650889889778806;-0.71972018630587342169 0.19585253376185907115 0.078641127575593230969 0.27493980596359557378 1.0130114529807314749 0.058528265658109909775 -0.015365819275761744347 0.28062522882021956327 0.0098111095434625910511 0.34826237412107746705 0.28359791421010860368 -0.20342692058155772972 -0.20159995400369623564 -1.1854319362177723196 -0.26935836627408599186 -0.014443047834831225507 -0.11258177108463433835 -0.13230694587896552061 -0.10260356492730533795 0.0025935282062951310438;-1.2692801100387935964 -1.7005458161802728956 1.3957667051861004648 2.8470009322023561715 5.193531857090605719 4.3474246342327473869 -2.6969907321097648101 0.014311667870873344063 -3.6712059634677518538 -5.7596312184362554731 -1.8151087273346084849 -2.699443906555315742 -1.0068453077171779508 1.2781895654371011606 -0.50093908490698235703 2.0912641896671848585 -1.5773733537994043541 -0.65315762465056304009 -1.9299898999216078543 -0.60357870253881806821;-0.02476624688573111216 -0.54939476416788601831 0.59642725380848904404 0.26298650367332832012 3.6090766893870984688 0.15438324268776829062 -0.0055304363993089094079 -0.012863962275388277773 -0.28766301530774057715 0.22492288587538006306 0.081871676904125348373 -0.093544642541485811815 -0.11970940090751135132 -0.67309761448478044876 -0.33408135673281863509 0.10907701309417945634 0.059004276990300544292 -0.13910424053540434985 -0.090169724807526122068 -1.0551626357310974758;-0.075032082413899719997 0.46772049325513748164 -1.0239634866825768622 -1.1236832937590446324 -1.0051431986681764741 -0.78593887748203383747 3.4975693630183508631 2.9705493437266747847 6.2396982779703673572 -0.063060228476505914008 0.31212229883100156558 0.71208005498023263513 -0.1912037508026051269 1.5326149062034579718 0.57120986709323051667 0.72117364498192537692 -0.24631989398066578278 0.14175414092066535021 0.31394001745773736367 1.9137406459318992979;-0.47355032487238885031 0.22022623185099932108 0.71637046848684315936 -0.012716776795279747386 -0.53658609760579989434 -0.17645502806696886089 -0.16894039194579069108 -0.0249854829974853615 0.048460017418540370093 0.11934502291969738275 -0.043140981666366880198 0.10899816011757861023 -0.30111232904582846404 0.76936178742179561763 -0.38933347152722397322 0.095755750246025297945 -0.011195963482565999061 -0.35855763308258892241 0.10818205095204902477 1.6780116922510166511;0.054364220435812411758 0.19280814454455247331 -2.1983619574869677216 -0.53142931404210147495 0.23506906059251236885 0.043079235424934705923 -0.5801444544764008393 0.27927384394197640738 0.23621676764343571553 -0.40515037303112466649 -0.23395627905501750754 -0.11457097091212349593 1.1212925826155344389 -0.84992987460012237033 -0.32910634811155259349 0.021061951198546455949 0.084457533535505682765 1.3338175035292658688 0.00067500308408543932374 -0.97314294615211138773;0.65404491182016755157 -6.2245054523032337102 3.2097653809790092083 0.80906257457248931253 9.1444840030996257241 1.7690458234640789037 -0.48889601542094829334 -0.26729041930224234358 -1.2129682600724080999 -1.6559512681784949173 1.7813498225315735901 -0.51295733038674118376 -0.14235190330076191723 0.2509782960144466557 -1.0264154038613446662 0.30067588049248089588 0.73452403701583490747 -1.9454124030115196309 -0.060876637394299340511 -2.2039620053013870837];

% Layer 2
b2 = -0.93756032933644151139;
LW2_1 = [-0.025717722945169888688 4.6358695266794516243 -0.038421018213983811063 -0.88670614194802443997 -0.11549514144202098487 3.5188316617450783319 -1.8825097788777997998 0.024114768438664103273 -0.013006584568385496509 1.4870661954714727848 -7.0718617687962028739 -0.018092294683237565567 -0.064397020420320263967 -0.017049206654712177611 -0.0040042955359708707133 3.9509667482271084715 2.0924807365520408098 0.51436882528644278789 -1.5646318449775189485 3.0763400000396075029 -1.6677368001248769058 0.40273041857566527213 -0.0020804204105827790727 -0.042642474201897394293 0.0076073079412238278282 0.0092902079501296485481 0.020037310064349500571 0.0029443529395205693226 0.013535507544288534823 0.0035698292942598856131 0.26705090056882252458 0.017193421831964442181 5.0045686291753703756 0.66460610261550912004 -0.61262864315003406901 0.030949143407249926629 0.097273672543840256077 0.026969627188378142435 1.4459396219786584403 -0.020866602887480312917 0.15881634551008375067 0.013668776925753798809 -1.1989250432479616748 -2.5615933412446727502 0.10704308456147862416 3.4774473947150177366 3.5735779009412049767 0.0091067556003078409949 0.033879102958726821371 2.8605395452495416819 -1.4820597091033005377 -0.020087531865408358306 0.35206892860040128745 -0.032389101908408074459 -0.12091369680495851757 0.60827464207967596455 0.0072691954544655650039 0.0094365654874229466798 -0.0020984521868990407313 0.014170480952715475143 -0.17163312949901146642 0.0039490505022112907391 -3.5520905571728222938 -0.3566204411596402557 -0.63585492147517641559 -0.028754152836401297016 0.0096329631073527825086 -2.4435863975304723539 0.012623666925724185209 0.04929698187827751682 1.1995111927234383131 -0.048559916875263481328 -1.5767824378807309138 -0.38894599549892111545 -1.9121287400224371567 2.1203247469914994205 -0.0069439208575928787828 0.2381452689188403582 -1.8539740954130452533 0.041355995091096033056];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.824752471164592;
y1_step1.xoffset = -0.720903;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
