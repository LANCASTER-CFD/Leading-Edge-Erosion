%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           --- LEE2AERO ---                              %
% Opensource machine learning based tool for assessing blade performance  % 
%          impairment due to general leading edge degradation             %                      
%                           ----------------                              %
%                              Software by:                               %
%        Alessio Castorrini, Andrea Ortolani, Edmondo Minisci,            %
%                         M. Sergio Campobasso                            %
%                                                                         %
%                          Reference article:                             %
% Opensource machine learning metamodels for assessing blade performance  %
% impairment due to general leading edge degradation, Journal of Physics: % 
% Conference Series, Vol. xxxx, no.x, ref. xxxxxx, June 2024. DOI: xxxxxxxxx.
%      
% Copyright (C) 2024 Alessio Castorrini, Andrea Ortolani, Edmondo Minisci, Michele Sergio Campobasso.
% These models are free software: you can redistribute it and/or modify it 
% under the terms of the GNU General Public License as published by the 
% Free Software Foundation, either version 3 of the License.
% These models are distributed in the hope that they will be useful, 
% but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
% or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License 
% for more details.
% You should have received a copy of the GNU General Public License along 
% with this program. If not, see <https://www.gnu.org/licenses/>.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [Y,Xf,Af] = ANN_CD(X,~,~)
% ANN_CD neural network simulation function.
%
% Auto-generated by MATLAB, 22-Mar-2024 00:20:53.
% 
% [Y] = myNNF_Cd_R_AF1_KKs_plus_80(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.02;-0.02;50;0.5;-10;-0.0008;-6;-0.1;-0.4;-6;-0.1;-0.4;25;-3000;-55;4e-06;4e-06;2500;0.25;0];
x1_step1.gain = [33.3333333333333;33.3333333333333;0.008;0.4;0.0769230769230769;833.333333333333;0.111111111111111;6.66666666666667;1.92307692307692;0.111111111111111;6.66666666666667;1.92307692307692;0.00135593220338983;0.000256410256410256;0.013986013986014;1253.1328320802;1253.1328320802;2.28571428571429e-05;0.0666666666666667;0.0078125];
x1_step1.ymin = -1;

% Layer 1
b1 = [-6.392419428485088595;-2.7883986627844130624;0.41245008027584484367;1.2209364811799707784;-1.3326208034684146053;-7.3271794424693377223;5.7362030395697622964;5.0841777852005414218;-2.3691474548331794558;1.0895085187983366559;7.4521908300262147407;-9.3626759299627426714;1.7925429700226669372;2.8587798436733877772;-6.6640773013270608871;-14.205352223480556262;3.436282728603165193;-1.1473250037785003297;-2.7522561514426175933;1.3433850921215726437;1.4573212165748024027;3.7725895566272598103;0.5451765166352398051;-0.38902681886174073078;2.7763303307033595502;2.1854426929420252002;7.2249927426621098903;-28.039468723961441299;-2.4997050127691893273;-0.68817212177737652201;1.4744958846459554902;2.2567673339477671846;-0.83072227769855588875;-0.24992292235424964919;-0.60156812009594862189;-2.1542293037964146407;-0.90949314786661294985;-3.7515125776907063404;0.51198875776401442383;-0.83837431535073114741;-0.30525887449164784693;-0.080557389073251162159;0.99123000934663840766;3.3927777978831255012;-1.0196087488820799738;-0.75345556407310076974;0.046737557939836117671;-0.32402225572377729712;-1.5137264191857622286;-1.8432041267778063176;4.2532789986432515406;-3.7979079800145791879;2.7078861844937667236;-0.29776648447771020267;13.127656004407132428;0.9183566764337590671;3.0741221105236591349;-2.7163626321464398039;-7.3539517117848172134;-0.34473072022657191837;1.0130797000457874013;1.0283848524070837716;13.14681079063492497;-0.63564717552144012203;-2.9794835584890715374;-0.53329520978158961864;11.402535381289391481;2.8193215635317687706;1.0416968747273820384;-6.6546228778883991239;-1.4784668630184989446;2.8297808364129228842;-14.160496546084434755;-10.658325502687397091;14.587690100610569033;-2.7208234318360746684;2.6623721874104964158;27.799012144748516562;1.929335228249557499;8.2449475235109837001];
IW1_1 = [2.8066268510726009033 0.49087343162723640067 -0.62267901204023223816 -4.7973804535383237635 5.248697621350561171 -0.2336149589630171497 -0.19385478233196867803 3.1499768888963837199 -3.7547326986095597157 0.028932696418227578372 -0.37693013234517780408 0.12347630621379765414 3.3293056298114320768 3.7238160141391936087 -0.49147836373243430907 -1.8078015454025104791 -0.25514633280225962331 -1.9235779137644999359 1.6559823269936673196 -1.6826426014630182504;0.23523754204432506532 0.44755886195143984585 3.1568780197970105483 1.7814906386765307911 2.1036309740761818254 -0.20701136098852812584 0.85381878939374633575 -0.42256970608272181877 0.24376985034772449823 0.0059471978085320906585 0.45252631601059645217 -0.55404591170277561751 -1.4629944830096919262 0.38157654733162760241 2.0500653838465505707 -0.23842777885631982748 -0.21749911373641417356 -1.9335993948264460496 -0.7511581941710252508 -1.0307759569958765411;-1.8570858837363688476 -0.038945373552566366071 3.0079551758238061154 4.3760545591408748223 -0.48574371632750629191 -0.22941699269034804276 1.8400847965051609911 1.2827294278157679308 2.9718903996037027149 0.1163286883601895999 1.3635715607124805349 2.313578355435665479 -1.9313649023220882395 1.8349651516220473191 2.2009687014301397845 -0.4608690294728569059 -0.64447390187753483826 -1.7133072497957633207 -2.024918520449630055 0.9604322695210835148;0.1120074701849094051 -0.70465094066139066786 -0.93545325377411181478 -0.25695901020191658226 0.6285738488283619807 0.00034738333925928482687 -0.19268702302795989723 0.12635927339743724396 0.15343612807062398384 0.89075474761632655873 0.093448637369026504862 -1.2283500789594321567 0.022681581451783224684 -0.44028202662574394965 -0.48719167008666491858 0.00027307753913730640127 0.23567057039763905646 0.72270849127181846505 0.056545100425312050385 0.28005329619222668613;0.27474382665854479857 0.23518960962302518092 -0.63983472309085565044 -0.68347584115134385474 -0.45727228327600294433 0.021725290925830968713 0.14869221561797854592 -0.082092896985197894022 0.31326385586069921407 -0.073967944157233248004 -0.53904382398334715898 0.15915447239114932643 0.12399487373097782539 -0.35430169906211278485 -0.2066313691419260079 -0.090685317475283952482 -0.10958830285312035069 0.28350207897103357757 0.46771555576627193984 0.45445475516608474509;0.61140824779798363942 1.7335234167867996646 -13.08349600292027759 3.9542342431784738288 -3.067042286026572917 0.25942739270447695565 -0.79073794227628668718 0.96192413137428078862 0.088621079395017926528 -0.85102824046015856929 -0.53531805007471311431 0.30766593259085683876 2.2337956337396374096 12.602996428911456661 2.4431577329581557478 -0.56193737311551938962 -0.77897352888190718456 5.2784547446721861164 -5.8165285749707091867 1.7404874370866521005;-0.1701667050536930792 2.001467177161585731 -3.960730027225273453 -3.6870264583244303225 -5.0583605800661421981 0.21856711861457925328 -0.69992856812219439444 -0.097382949451454814405 -0.10724225645091585435 -0.13513789246883037287 0.77629736789217507198 -7.3079149708071264868 1.7238138607505024691 2.7562049012678393467 0.5842155154758450486 0.43891268618284051684 1.3750417025024874729 1.4113771285365210861 1.4210036296415979873 0.61692899308198634323;0.67990784832844530783 1.7919410977804843821 -1.4150533909218818707 -2.1410772756030356234 -4.285480405612028143 -0.49534677415469990924 -0.078998155644263282071 -1.388230060340992722 -1.5792618896605823409 0.45435202934479657078 -2.9273260448763180896 2.6715835785499688626 0.93264559326998808242 1.8573722524178895021 1.7195243059567062449 0.38874713608729338787 0.29373849628195852768 0.51496118005847968391 1.5081906637173694286 1.3425247056284144165;0.38547313148032474883 -0.43901972626308427561 -1.2970506981835534521 -1.6153230405933574065 1.365321742147624251 0.2427534375472427397 -0.92291703367538147074 -0.55415707254137092086 1.2569545369355292763 -0.019264871965575719459 0.025587295398287905612 0.34235437795590922816 0.22990243577967683919 -1.1688106364927981495 -2.1362597180675861885 0.28396112076189761186 -0.059694336431472511117 0.55210557118792502607 -0.31874388973079120779 -1.8538197925364425789;0.096130399403371702416 -0.69739707817193652417 -0.80763811098481308459 -0.41236383226321099427 0.76615644450262121445 0.037643616765434123606 -0.24893676740911768741 0.0455877390733180482 0.10767660212547483511 0.73846694204498752878 0.097493146726702326066 -1.1053599715354740507 0.08276790447831632036 -0.63266762163449330458 -0.34606768780628838211 0.031279380413394820837 0.25825361825851927966 0.65120498605088394939 0.17447185670168005589 0.031781038889586277207;-4.3611074564601883807 -0.93334426090943478638 -3.5536256352108548384 -1.2809056302186232479 -6.6713460651535170243 0.22547531714900903577 0.39351543317895315566 0.68538641163061664319 0.057265764536435767584 0.317770304336208953 -0.28007975020970188318 0.9532968121474520995 0.4273181342262941107 0.21814798878276833727 0.25497470199717514605 1.6282406585577802183 0.062823699677728966906 2.6666586055085361728 0.77250793651565874409 1.7235294040224409251;2.541660546551612665 -3.8925981811865115745 2.5173791128233053982 8.1688971695758567648 4.4150567418644293127 0.74960557449405762487 8.6238622739271910689 8.7484694973613947866 -3.366608090419966004 1.7721059437384225621 3.0852312979970277773 7.6407463905394248371 -3.994550158336612089 8.9491274000801919186 3.205719992227838766 -4.0739241739340243953 -1.6577669557368122089 -3.2532059566619024871 -7.5747987038594315479 1.0859878735637338298;0.042860199354961776852 2.2766034599911364467 -1.0667264829528120273 -1.4913691950946164066 2.5315056807764677593 -0.49795021914935405638 1.1831845125398317009 0.081023907014301899121 -0.60960650677996908176 -0.56694080928585721679 -0.19965315227478214188 2.8432030255009199671 -0.0135518335025445677 -3.4375807194131193789 -0.29780526933848239235 -0.23096026194243327034 -0.064925818264628634702 0.84924912201930757849 1.464558453896670942 -0.30992441189796210432;-0.24600408828723141497 -0.08003746849945295172 -1.029354615221052871 -3.8498929443028320208 2.2581900073683005559 0.063891095843434386747 -0.46681581251239878672 0.24611565002343238628 -0.42984088061730985064 -0.17845563108984280332 0.18446076086915624836 0.27363028997891031269 1.1486573097553804956 -0.4365373947967603474 -1.4591601553503525945 0.11461348180342456615 0.060911852325322250745 0.4447856828634648152 1.7597066070942715132 -0.29512054047076557994;-0.44230508297834436604 -3.0490996821731899402 2.3648340226829724919 2.5903167316105211171 0.42842857518106503001 0.29084911060386559045 0.078153349966018456629 0.51940990924277896656 -0.11919231658375538385 3.5747072606960919039 -0.42411936475224032428 -9.2899592203649010713 0.96414705217405027859 -5.1761507992818032164 -1.9566335555570866234 -0.085861143183653440558 -0.22350676344803177553 -2.0093822446295583894 -0.85716838556875185606 -0.050978898810444935041;-0.96049009455292577719 -0.48075438299054618074 0.33436946746370072026 5.5552263428863932759 3.6802435950039509294 0.31409601012303689505 0.77239860860728826175 -0.13131341105343327658 3.0838102041907484718 0.92168744229291199588 1.6074808691998725418 2.5080139977481219482 -5.3138088000961456459 9.6089942595428432526 -1.798813370198697914 -1.1715705213621168124 -0.99864538763394616883 -2.9511969890228990643 -3.510356583241639683 6.4334259659896861905;-0.47678058531332306869 0.35196008168016634787 0.51325267660329232378 -5.6014366997139806159 0.041360367816919534067 0.90294419186840391145 -0.77095923099532392975 1.2305133712968392423 -0.036318780780918769047 -0.10531423172356876861 -2.1745102590727758418 1.9120853116087381807 0.95910507851711290783 6.6743642553599507039 -4.2936659506663312769 -0.0086954304727012605991 0.059749902560603335155 0.4980284885281284768 5.4824824190119105793 0.65590724845522829778;5.2701545291525535575 0.84082626236650659379 0.91588313752918926181 0.0082439245470922774273 -0.73495347501093832854 -1.1819317505050630501 0.5836124614003829203 1.1475690908052544881 5.0840297846051960562 -0.10275126322319082239 0.032648757860451960156 0.29817696070696264599 -2.0535773322203390023 5.4723249288457926909 -1.8905640966236569867 -1.5359885057237250283 -0.30867215155128002735 -0.18468150066981794954 1.3310788928308807666 1.8954171935673675975;-0.33608211224826983754 -3.8258323224744792412 0.68650991555296869695 -0.54284154117926575189 -0.9208674795299152116 0.96023039037471780155 -0.81766985443692841162 0.090559539645791997664 -0.0083428583689251975541 0.52369414315089257705 -0.46441573997251744954 -5.8152555384007937889 0.041377772620895127142 1.5344934627879074363 -0.25344746382963040388 0.22920513140634693472 0.062282588756577106359 -0.25530649498203977776 0.48402767617301772907 0.86514334868657538635;-0.34260334316639956542 -2.1897882588414350202 -6.2583743197227361676 -10.329805915878644385 0.16521378416540904999 1.5030644861847430871 -2.4299768972899382646 2.1330528621453033189 -9.542466376955339058 0.79470796167126389609 -0.77473326830379751762 -0.33560285693988683997 2.404784844863640636 -0.73837200966126936841 -7.9485137187043228835 0.47912669796979812098 0.80808881777962371373 3.7341853834199572049 8.1616836372166314817 -1.9632440870036895753;-1.3919995429582210367 1.2074541488640178066 3.2927304959168495202 1.6787976604588781271 -2.7298506728695621781 0.40015880928141728257 0.13418276324735708971 0.55566326576399927006 -0.64917615536679296184 -0.28528121170277892515 -0.075202747772605063603 1.1394269982343825376 -1.2280922914325658191 3.476044785980388685 3.0252900789906385093 0.47147239348471337017 -0.83256433385842876227 -1.3441257190971938051 -0.2769055789427761205 2.1149768859777502428;-0.9795672098689039986 -0.8471700373011926688 -1.667908852305547196 -1.5336291319456587523 -5.3834167416081886159 -0.035624245139174254282 -0.62205709119753349601 -0.7571509402713776371 0.45027263838970116305 0.53081963700036638443 0.21707192592348878435 -0.45499602112214726501 0.77307630332109777971 -1.2892586785135922156 0.94506646805597371852 0.39194339683886703085 0.37763172868664923731 0.60107637637824307131 0.52128230748515402837 1.4679820495562128091;3.7218149620672407174 0.46772646963801423059 0.14427671653289142473 0.14735784752013106336 -1.4445905819843964935 -0.53689600699316930577 -0.46227220163743093506 -1.6103533438491857144 3.3616334016693740772 -0.29244976603945821436 0.25701889512777675861 0.30201167207740803322 -0.45119805769920112715 4.1504718554775186234 -0.34765242628773729283 -0.50853397456871107796 -0.27738451150125864597 0.093912033470707242944 0.27626198549516367553 0.90936562632685336016;2.4942935637060230647 -1.179761319111893636 -0.71546448306209242674 -0.86455000064805065385 1.6441547309385544651 -0.21415196040100359376 -0.88864333305092380044 -0.89610148061796990326 2.2046827089403628896 -0.075071529915538892652 -0.093140272743000171451 -0.077821567470457098104 1.3645171632827450825 -0.70376928854027787086 -5.0950529435568414627 -0.51849112992327572869 0.57173075270817541593 0.12594124950923180073 0.4449672183685319804 -0.48317406594621781224;0.43279233589460830434 3.8726591757763655366 -0.81631920037372196486 0.51036128031233185531 0.93742875128423508446 -1.0302859214118680331 0.85045865938299824993 -0.099001247896692623485 0.0051665584967481624837 -0.51787710897047334324 0.54784730549312821157 5.8350547600150060035 -0.0693722369115034182 -1.7000335280629590429 0.31464686442424499857 -0.2745873426753148161 -0.07439230716897145268 0.36452522149753335823 -0.42947581940710533033 -0.80510542911803228971;-7.0289736041168353609 0.29832407750510719913 -0.70350443535814233265 2.8136043140529789497 -6.4687581568741752136 0.066463228393257398063 -4.3922989398318819099 6.8815915373674636513 -4.6127000402044391336 -0.56105787162218390129 -1.4563802543226589403 -0.45247463860926562251 -6.0361103563696376639 -14.309472513769593505 -10.439143611407571299 1.2436208629762486311 0.39873751076941327254 3.5733992596339425596 -3.1390006827242937781 3.4319052168724364371;-10.64767270481680228 1.1195693847271002141 -0.54511993190564689282 -0.59930815697160200184 -6.3821020004387953861 -1.640740205401962859 -2.7540201287267094266 1.7164904984783673214 3.6324818486046797084 -0.072372296513920103544 -0.24999036368599591995 -2.8948966936834246155 1.1238631659906244131 -3.2671795330743043095 2.2332775944485567798 4.0797872142636526505 0.35847039636286376352 1.2140272295419787252 0.34578474339520726133 -0.41711688495143656175;0.46935249404259676842 2.6418167683661497591 10.903736718096320502 12.075229604438364461 14.615993250384660129 -0.027625447523363714369 -1.3295655188376152012 -1.3064786735761781955 2.3747060955294472251 -1.6950796167442008233 -1.4246143262169799204 0.22386361437109963957 -20.196704062906587041 -9.6969913236372011767 -14.060955467740281932 -1.0900250616553996963 -0.95848182219833255591 -8.4385810916690449091 -5.2044879444756606546 -2.275987551069114545;-0.012526635922431734668 0.69973631762096033526 1.4650854752544284487 2.795502257473378549 2.8607535708781526296 -0.084360585772651500158 0.69858174720354726528 0.27685915138273353708 0.4087280677759994596 -0.38261113586658451746 -0.07599865953044820932 1.1992992887040345718 -1.6491905458472067014 -0.053834721884092398558 0.29934454993736026029 -0.56492581501778704745 -0.57016744761505555594 0.06591299068234700298 -1.1173684121833948879 0.44775248166109610226;0.34557955169824250419 0.50163895622627197035 -0.85650485154919087094 -1.112101613594193017 -0.63219093057333985985 -0.020048220908343194341 0.050690211377058327913 0.26174512441204078605 -0.010401677178136800248 0.073237646054295099662 -0.13810077010204441228 0.11339353156142929768 0.070022650055217378062 0.36998462496091227836 0.99788295059665621523 -0.1895519838078834618 -0.24757773710474362261 0.53830957266424872554 0.2569989053233856513 0.75849565091240722658;-1.368348983015207132 1.2031791450883970729 3.264228071545767218 1.6490438892924994541 -2.7272215092938627556 0.38997080081455898215 0.11870210238044634488 0.54440893033812154389 -0.64682657053951486681 -0.26684121521667963917 -0.063084625912055727892 1.1456688373002767989 -1.2099386191177572414 3.4870194240067049485 3.0140515464653954147 0.46490134881742350981 -0.83676363984735913082 -1.3288938365645721618 -0.2495503061415046131 2.1195203570572260787;-1.3623624776544742687 -0.38668704061078668088 0.39317329803154449364 -0.31519017612457062016 -5.3314431255815941668 0.33933943811495248521 -0.84343872032231870239 1.4803870822031397481 -0.71456429978610780385 0.015683647783552943228 0.31280814870095841052 -0.58927012184322535848 -0.71715907430833281122 -0.73032083249814272463 4.3541826555642781926 0.082856308048228619056 0.22089999262716372708 -0.21836285088125079179 -0.7122912958439462372 1.1177463239777805093;-0.44355420562900071957 0.48406226667303242639 -2.0890892609992732787 -4.636707058714939933 3.3285353132015194078 0.28061105185270068807 -1.0194156375955207849 0.9490694211679738812 -1.0135673113115080124 -0.65318159541979836646 -1.1946609186784329371 -0.74308091142304910637 0.41409937767898885586 -4.3602339720582303784 -3.7244565540988006092 0.33452466519617612972 0.281916390589240895 1.3928799574768337965 3.6852564816696271599 -1.3416440647486744808;0.11414105852874131819 1.7277027608247086388 1.6817299444025273214 1.1024511423156189149 -2.2453892275793996269 -0.26288994095695200626 0.19378073106830309702 -0.12190129102011437734 -0.093721408106223355605 -0.37519149978400695433 -0.96470738511311504571 3.4400304923136753033 -0.58409548095608865292 0.9421503471302729027 0.0051198716265801634193 -0.12946748534736829406 -0.66824911365087180659 -1.5336658697995551037 -0.91985852875625750968 0.21501588268542312643;2.0117419374377263352 -0.44743202515340857461 -0.90451069402687933607 -4.0246073258246193305 2.7603918568132801425 -0.20967935939285481384 -1.450534584948833583 -1.1595124523219793033 -1.4792986357109048079 0.2775986423218402277 -0.39969118369584483164 -2.5137368499469503469 1.4014047031575362912 -5.5973626107308236399 -5.2464718984805633895 0.15494888269470818987 0.64645095108771011283 0.61050967836601377492 2.6805618587046056156 -0.4796347934580229011;7.0603843599732725167 -0.30555750527445374454 0.68172683023891600396 -2.8365229633949700094 6.4088263175592770082 -0.058556249905104808262 4.4081529206747847027 -6.8933616944184201714 4.6501597102482952195 0.56502806191025489735 1.4753427940867041013 0.45722614118987892073 6.0792676297943293307 14.450553677493701343 10.568270818091965779 -1.2526124967763794249 -0.40407067402416002588 -3.5857532354038901268 3.1461833288644096562 -3.4373538619307169029;-0.2372597642588173128 1.5449244736384939447 0.13067944098213207793 2.0579796267698591272 0.15299898062306427349 -0.15009022134227520406 0.022353237978674549147 0.31480244244094679473 -0.12359427642947179438 -0.90555158408279801119 0.98798965443877351245 1.5685421329852613503 -1.6161314980791459117 -0.32957986389155480289 1.1043258525755190735 -0.075425488948265423383 -0.62403947969647699523 0.17702385310962584497 -1.1888662619775784979 -0.26074317206706665306;0.46442433688704237715 4.097403886956515251 0.30065446804077666787 6.8206218872988513269 -2.2324942819300681585 -0.42596113220484466133 -0.13787292844314474882 0.33611040624092358708 -0.58129327141610032115 1.9040968606505235261 1.4083868235290295523 -2.3342728792159448403 -1.4106851140790686028 -2.2706292844582431911 4.5340896820695144598 -0.22117382312551600587 -2.4962249377782654847 0.18464250925514885671 -4.5685445668997877178 2.6264123085736565955;0.42283809076512801628 -0.54588079204495876251 -0.40526371965162805155 -0.76161199535498325108 -0.61664217097394480316 0.088676920200902190072 -0.21657498325133681116 -0.16839290683753124767 -0.26133031319346916588 0.25884047814719907121 -0.34937945368628520182 -0.37797260226468409883 0.56657781915540084139 -1.0056289184805078385 0.33646729905728850474 -0.098070372313881021276 0.234300613197359342 0.32598404183908796794 0.67808075776552545477 0.24693306855168392633;-0.28035361932444180511 1.4707980628122785394 0.21001194268743314519 1.9503268805581526202 0.056561464414362522257 -0.13029575888681277362 0.033803610401785200157 0.32053221564132255983 -0.10621889822439385676 -0.89356294660149271358 0.98167368782871133881 1.5458044459324409292 -1.5453182739696844639 -0.090498351638622756554 1.014885155480348411 -0.058764201738481111614 -0.59117831265663423057 0.069179689607194977397 -1.1324567169592310023 -0.29198321522087755664;-2.4027180701513346506 0.18513889361200480677 -0.11596101590682572624 1.0542522269823402237 -1.8882966703435686284 0.026258336823300917201 0.2263833192109854231 -1.0671733235956120112 -4.9380046578181557848 -0.17105146920553374046 0.062820784585481140305 -0.46314386478355051846 0.41650298076028796634 -1.8529695519005726645 3.756988726182097782 0.75685603785169541791 0.0060286210155986738948 -0.11967785031427728704 -1.9358156459648150349 -1.3692182375186221499;-1.820517541204644818 0.0081703360774483327345 2.2176125267345510039 3.4691570333900711987 -1.4381957275878396452 0.18896778796516108812 1.2184296655252233599 1.6745861567461961528 0.72240410001793942119 0.20718643423123730973 -0.0002938879709132240052 0.19029922905284507584 -2.0356455324215243508 1.6546136650607261576 2.7775621911891472671 -0.25279117949934870602 -0.11330776660219503416 -1.0901260616789658631 -2.3708406287021404069 1.2731851413445325338;0.19925552352658112976 -1.6248775577611036525 -0.060168871060005721385 -2.1831670586242344356 -0.25333379047296461506 0.17156968536740155318 -0.013963109930701739225 -0.31056705003061135795 0.13690526615303386104 0.92915961012899217497 -1.0025661296725969507 -1.6071344564850458259 1.7046189517701706428 0.56968789450842716171 -1.1946105445154866498 0.092426755917831976417 0.6614627533957339045 -0.28337303263393981423 1.2586443898082337878 0.2363181917538180743;0.50727869609658615691 -3.0802971913233814227 4.8093547965825518276 -6.5760712315649865189 -0.49716982125845876617 -1.2789617511043285258 2.79618203129635301 -3.3508786639311347599 0.030100045867155079266 1.4977090060134212735 1.2147531669240649865 -2.5135902585964005063 -3.0497669366363822085 2.4785320803947823443 -1.9786697420819636672 0.57439753576097507537 1.7917309066882427526 -3.2080255021727483999 5.6078836391662836292 -1.7060743711583257198;0.64758120181783807023 -0.057287984785492448991 -0.058886315994266712204 -1.0473078615027877625 0.28520004806651105822 0.12152586691544151054 -0.84705518788718792145 0.022542355870443779586 -0.07542921322605716794 -0.56748513743097128703 -0.55405529449026380551 -0.11008692061774615067 0.074522529744004820107 -0.41799296731460383603 1.3964403010791215376 -0.011797670544789140568 0.088277460400294521792 -0.16622584889022853916 0.085423991492394601988 -0.40626687463299615555;1.8550351521033874302 -0.27305567442157879787 4.6714093825943754368 8.7550181925442043251 -5.3569598241799321059 -0.25496860465823906194 -0.66858810771888976809 -1.66631188327213553 -0.44622910481584898701 1.3390941785654233431 0.68183175183272071163 -0.033969580342101214632 -2.5739961619540201454 2.3162742934061051336 5.3815642319971024321 -0.33268084416201870734 -0.53025977624777109742 -2.3805065259167026426 -4.6096304171167110653 2.9969739870772116319;2.1868897474858965957 0.15684183010534855085 0.08521030135664592331 1.3012040275633163233 -0.488036129364106952 -0.2211054458373818421 -1.3841029000818210193 -2.9964038134871855412 1.9804192340986372933 -0.46774987472201901006 0.53900066587888451064 0.24266886763644868186 -0.24754790751948446692 -1.2832862775990230286 2.4061265025930387296 0.51958216933921586023 -0.082174652579802942576 0.1891435642302626563 -1.6055675719769610943 0.57123343006449200931;-0.12563927249021689114 -0.90577370729451511799 0.75243402592203267876 0.91565911336824623579 0.69109968042047598136 0.084750944416736292975 0.049982779122715592646 -0.080654734505031508429 0.35119146402762996262 0.56956928880353707711 0.16512451109264755789 -0.75565669465668316995 -0.34104140123906312443 -0.89029193000078254983 -0.27322798854485652598 0.040209533365494043444 0.12858803130670609649 -0.3308940815042072936 -0.34454955928334540793 -0.054784747513807671715;-0.22369154493950893503 1.5084960333692560841 0.67074927233605352583 1.6442214652038800171 -0.053929417479026207916 -0.47232397324455405174 0.29431069117994462792 -0.16435148640760985361 1.0519335460448480113 -0.83999458668771476155 0.86604554816004553075 1.4175552443303274242 -1.0530963319407211642 2.9285669153152356081 -1.1214650846143516816 -0.14270639902765588913 -0.60384210205247557113 -0.57627342149239246805 -1.2905769873592418673 -0.18897500757926496973;0.44405889498822675998 0.50536381590228429683 0.95208257651862493454 1.3143777499466975378 1.5937772703950474629 -0.012502792431168880533 0.87569824617041236436 -1.3771974967058657757 1.5552526694592145873 -0.34490617277377749739 0.4268079960645879134 0.40304284272094847985 -0.67824751389663651135 1.1012997141935036982 -0.29321621053166796456 -0.23328793652781015799 -0.30176738960050469851 -0.53127704025569966184 -0.92051535341349921548 -0.94727704635911480491;-3.5748788648217679764 0.67168230924704441787 -1.3131315040926019311 -9.3949586917053835577 0.51075015674685131373 -0.41499125893759858386 -2.7948930750757625674 -9.602737080668399372 0.81428108780729790972 -1.9500633414118631048 -4.5346299902206661514 -4.3072170215958358597 1.5166856927494505314 1.7815549111420907469 -7.2925468436493758873 6.9033852217606588297 1.6874641716311513662 0.0350192319186484885 8.0537481397985963838 -4.1931756889897187079;-3.0533010312584121237 1.1492677551750261067 4.6972893108427911102 -1.0168579039102563222 7.8343095068635770772 -0.2410717476451857133 5.4370645824559309389 1.3429859353232369568 6.0042691303681126058 -0.14833078674080296677 0.29240279510085442904 -0.60550742665645174156 2.5685102548189484573 5.6985151981797823595 10.540347880907788181 -1.5998993971700059546 -0.3188919939051300112 -3.9531340543819961653 2.2932612944323760296 -3.0040770048575096141;0.18738214897870730802 3.7457387470389340578 -0.45134912760305595514 0.57507631515891366458 0.89956389459449204171 -0.84467415874510842766 0.7478600921469159557 -0.094449469090693197182 0.017365210989766264454 -0.56672509291276595977 0.32366729286812268018 5.7247826859196022653 0.011160552065656369897 -1.2747394454943208331 0.16615261467669087403 -0.15798775527107492 -0.048146472565324005544 0.064196637433324987843 -0.54647527042036148082 -0.93116150380801643305;-0.22217140800388879285 -1.219146327316883438 0.88385279232558722207 0.78753973848683456183 0.62963908352152619941 0.052214353718682778027 0.17470058599382526365 0.052822804247959917467 0.090694281392170880696 0.94521586929814316314 0.49970973872463181342 -1.1204965029142353039 -0.42138520542070789787 -0.32977070564600979852 0.26047827065410300573 0.032548499577372651259 0.13602196568473054472 -0.66983739610675729903 -0.42341662756181519534 0.23487600602777622405;0.57945465083207903234 0.56837650860034438782 -0.66983916444856117511 -6.6059581633804125289 -3.2302593825128527172 -0.32014605697621906222 -0.86474352618741501253 0.22196322530566678366 -2.5550095193317186038 -0.96309272792869737856 -1.4724776406875086376 -2.5735199762092166864 5.2446065967256956242 -9.1273417640348313284 4.0426525227648033578 1.1238035302122215686 0.97133806527792365682 3.0699691584987145454 3.3891459498363998293 -7.1493162810831938359;-0.098049578804681528088 0.049891259133621308763 0.32001752860502069575 1.1947432034319749317 0.13886556036475308784 0.049482663636586363132 -0.025397052298710209167 -0.27141976328146594222 -0.0055247732890227711777 -0.38672923924759589065 -0.16142558675665025225 -0.10697949190594467639 0.21648906047013402598 -0.76453476367605577302 -1.5172798732124936905 0.24358616637270008587 0.16141793840740661925 -0.28200220163777917071 -0.6117085905248544897 -0.14850458433974458861;-0.016960774025297033207 0.2709582726780024875 0.1945936511836247329 -0.5713358079819369495 1.555129433778972059 0.11122877242116872842 -0.36226777779951851999 0.1366655581085852722 -0.3556634968233276517 -0.025961073190544987216 -0.90782327935836648614 -0.40284492361104379254 0.94868578713104501077 -0.56094404375251605277 0.66481338148559632195 -0.19898111137226096035 -0.01645750997410205807 -0.0040003427722545706682 0.34372825591596384287 3.2245080855015304522;1.3644636052422496331 1.9217118657163334561 2.4912490299193481569 4.914985371470270259 7.899830175249960007 -0.90946625485449061888 4.9356480870377561487 5.0797849050057228837 9.4802350542004081291 0.6518029299546228561 1.3692633866601375825 7.1403402836427796174 -2.5539508515438225089 1.2483977451893062405 -1.0690556699744728775 1.2841001804659444296 -3.4858898865034437797 -1.4072945721702319055 -3.3287614679735146872 -1.4375648055797163316;0.61723033061923049392 1.7619313164598551236 -13.176226435910221468 3.9107861145001310277 -3.1074383130158755861 0.27298388216871261047 -0.79597929591353966394 0.98619599915939248902 0.085201948564231119732 -0.88034341951325389974 -0.55611614548573851113 0.33793417455035673624 2.2623947349511368543 12.582085677035520277 2.596524958708132047 -0.57836326978583363356 -0.79803427227660206356 5.3563391283217693939 -5.8758542878446542446 1.7578551459263926926;1.6803579637207577413 -0.030272789264524275349 -2.7916959643641749977 -4.01390205442541248 0.30448470610338940201 0.15750555025397400266 -1.631614057305775356 -1.1315430317396493187 -2.6101826239461760615 -0.067412610674074072148 -1.2005291112106986073 -2.0560832679868519257 1.7767682954184964572 -1.75175978682521305 -2.1089999344010541549 0.41108730112012192848 0.60747300444022123145 1.5477633168684818976 1.8607717326162931393 -0.84318580405233456432;-1.5007678206941059695 -0.23417692838523523902 -1.4417874582702945307 -0.69739970641272319707 -1.0044258950500415395 -0.0092736264849078396677 -0.11410016129807869223 -0.45710661838863164697 -0.5910918120890726879 0.027962689267325251119 -0.26611811262553269897 -0.2764359450467808732 0.40163636592163098893 0.34442234713261898893 -0.48185081557615955239 0.90677872945365056712 0.15277493230004010605 0.96660043578854104585 0.42920595629321667275 -0.6065852885627559532;0.091132286950085836241 0.44710612128298965473 1.1142273813241450053 -1.4181271195823588194 0.5201856965452080761 0.010543431600029962159 -0.19450084505694731352 0.99513916407254476848 -0.52071107296357199701 -0.57818249050153258661 -0.0073560003224006900377 -1.8096819354393149926 0.58489334656809488511 -2.4825000563892958283 0.23959268604269567948 -0.36858730402108930146 0.22974408787033884227 -0.60143132819162481439 1.9061453561950703062 0.99886002188634104293;-0.34068498556000287314 -10.057947929747404814 3.4801159204807148306 -5.2684823790750288097 3.6107492558790519332 -0.92202425689495748351 1.5880663929029885661 -2.75911515540888308 0.11914523172914560922 10.132887088803460784 3.4973950341080519699 -2.7470263886342265458 -1.0939418329500736338 1.298521581059682628 -6.2347196990302524711 0.86906207603211815815 4.5505047672383973634 -3.6125778708159175245 8.2372268108858666125 -5.4004480912068224541;0.83460372202000299158 1.0903460330379255439 3.0872340387312746657 7.5746216596244213548 -0.011611728935892511039 -0.87210883959316698455 1.4847487390542042363 -2.3508668735794784332 5.3765838910093295411 -0.13412964929204115871 0.35343620097894157261 0.57202039159803363955 -1.5882719062733245963 4.822686667894700463 1.6744051333543719107 -0.39415676417003076004 -0.52842046190674551998 -1.8929348072221279242 -5.1088401759004522518 1.6320389629663376585;-0.62629424995721061364 -0.27061740261855959933 0.44760052663597638123 -0.53155801304538863317 -0.0074172165872839149886 0.31544909764116896289 -0.51881553422818271759 -1.6771495972641754513 -0.3590730579491867025 -0.21064683025354477564 0.53046235724040891046 0.21846087813479977968 0.54129285309359043143 0.098784970603496127795 -0.65385221854716402134 -1.4963458076296192178 -0.077171315155553699139 -0.5413089851022214738 0.40256216973208386323 1.2146279259366421499;2.4071433787438185625 0.0049166488095979121731 0.99254490756996072154 1.7701252978832178187 -1.1796425173153397559 -0.030107164813435633582 -0.30180902882100674178 0.149121462819269468 2.5982236876400541803 -0.066424907120592555088 0.32050500394356074008 0.71304427532113023869 -1.320159675595537152 1.2380290461927492274 0.67439084137545357578 -0.82994073527370260113 -0.22422615976150431227 -0.45090911977185132997 -1.6468659936068428262 1.2161885147890005854;0.29172074280407211955 0.63128683054446144141 -0.93300869502917960219 -7.4494960718581477721 -1.4983746445536563208 -0.32464670995935274167 -0.93947132513042641566 0.29389775537344953182 -2.1587505133786653033 -0.99964947721983288265 -1.3705252795225117968 -2.6244957650485676304 5.2094470552563842958 -8.7933955256103164544 5.8264759053553341062 1.08896545168936143 0.95313426469015416487 3.1762895941438751279 3.2974006138155491641 -8.2053082902775180685;-1.4263668784508114484 -1.9245000292604264036 -2.4839579861487663948 -4.9150177584957033261 -8.0159395619335196415 0.92029537969814323439 -4.9417248411411121012 -5.0683371327080761759 -9.4056551393273597483 -0.65610704567616773275 -1.3699408785749935813 -7.1378102914588632544 2.557555038015475013 -1.2188415651209676405 1.1352167049967301082 -1.2613396378706256407 3.4829124370200017502 1.400916268519795338 3.3196425623765746238 1.4931551408983607665;-0.12927714944662424545 0.11184048416976209717 -0.19646346532489394887 -0.41577209445175661306 -0.42525379252636341665 0.034032128621108673205 -0.012565053237771937195 0.040998676558143411219 -0.13292123465353378187 -0.041354127030956269739 -0.0097315171583771120645 -0.38430037037391806543 0.020015636114962442188 0.19287591356606528792 0.33066357994380529695 0.040811562525581678018 0.080425613342692950369 0.074442709867946918467 0.13424668990401017465 -0.53624597592126832524;0.66418850023897546553 0.094957168690843654635 -3.5443989478419548611 1.1081440144855483343 -2.333072804880784723 0.024603037097463597432 -0.76885256644866339926 0.17912570405126665429 0.098400990844578553607 0.13202831598592768003 -0.15548720383581648985 0.30063869170292312205 0.84921557352062826407 4.8647421366966190348 3.5096518919530388381 -0.080227940618421575425 -0.25142234168330973576 1.2126272373606303834 -3.0285955343580730492 1.3763112238665025089;-0.30431643668264141134 0.11420437624621936068 0.68298001287798315584 -0.63103648336364148719 1.8921725757336091966 -0.011824017313434869239 0.0065044494426097915207 -0.1266084851056301086 0.12993097266496159148 0.34802552068423137088 -0.082422375925021176823 0.032202647559524379128 -0.61163053046348625497 0.07494926288182658658 -2.692702725325365698 0.1282174809849130348 -0.051038178151123297921 -0.56164505231022510134 0.5999825926379062091 -0.68272096732631004645;-1.5889949117588542116 -0.22452000836871033318 -2.0320799179981201554 -0.72929333991058464814 -1.7331044672035214038 0.19316916885308810237 0.037974233686437861013 -0.019083242019990065419 -0.4171833263146469406 0.070165382828349165401 -0.20516892860976859714 0.56945199623391118404 0.38761933831956019159 0.28257769074890687344 -0.044036013516876693075 0.84259925005920721652 -0.048307582392593056975 1.4320012843625857801 0.75639721584550112521 -0.00096628687901289503533;0.43334394227415323764 9.787267692993799173 -3.93368716995392953 5.3457280094480852384 -2.0718753892159287311 0.90057626277456603869 -1.5621017464724105128 2.7160463777849108702 -0.18995612825516658417 -9.884521257342973044 -3.415170180808136724 2.7372305559999148272 1.1794560270827816328 -0.73744634405570752556 6.0149823684305436799 -0.86855408234688225022 -4.4516423487671579196 3.700512591395259232 -8.2388913099476610569 4.8757986740681946713;-3.0448240774257615548 2.983959786330581565 2.5916140228876218821 3.3167357977142510883 -1.0000999706295319314 -0.23466786913886950039 0.40441006180899108369 0.64804885293686531611 -3.2238889706098858845 -3.4807610750003652456 -3.9495499458264982096 -1.1594414222273543569 -2.5121173261781191144 1.0367817866013895323 1.3974251445454477505 0.39665210128034872339 -6.3034277318663134437 -1.3746074968780677139 -2.2064223511745710837 1.53861911431023346;-0.56655035185066371373 -1.2104668516606751361 -1.1498875573715257037 5.9863511040035621846 1.5243173993621264017 -0.15494380904355711803 0.11924624696129186574 -1.6249795333163452593 -0.49276994611959806791 -0.14803253565152491023 4.6035594524161735919 -0.29220037213763871975 4.6161652077465582522 0.21130862992074536666 -7.2201583548353500674 0.4091254098715162435 0.42260326374115886328 4.7628640515065381322 0.22723501329969439388 -1.3326604758457072375;2.8487041572485178875 -0.0051989826914306831035 0.97714975172720275332 3.0303146753048886275 1.6853070717982532312 -0.36446388664861628648 -0.34599707650567135264 -0.22880979129359171886 -0.032229818600307075238 0.19160977272390611326 0.47805639582416004085 0.42567086980153912013 -0.51893028457587819791 0.27089798654624325236 0.094472628081380516374 -0.7952381122145819603 -0.19004231915113084517 -0.52741795457221518628 -1.6969544808843557426 -0.46721413862906552295;0.24431366537654972126 -0.53742836888965994646 -0.47997501168547346273 -0.65936232640167991015 -0.32934778433827938127 -0.15385605756986805992 -0.39349625202862942297 1.1908443219868145579 -0.36482492752947126569 -0.31159711430586539693 0.46705916694747562357 -1.0113912825685871244 -0.053838067040921137874 -0.24207813349426937632 -1.260748265141965696 0.094954490153354789705 0.21180986205146595802 0.49688403293053229337 0.49811285847399711102 2.1165220727385767319;-0.39636529523269425912 -2.5848896135456387313 -10.672725950225713021 -12.356103006295803937 -14.060296225014889515 0.034681254853794432624 1.2864746525862356119 1.1586074303971340971 -2.417482874094834866 1.6545943047910396384 1.4784096202119527685 -0.22012287902189273114 20.552024431098377732 9.6577432199602526453 14.48355708384791285 1.0763872055800520755 0.93098171935703777358 8.047354452936913205 5.4640381187809552443 2.1301342574600612423;-0.015207962817539432201 2.0724739322912064665 0.96669997861526402172 1.2500826574906733768 -0.40830686240017988187 -0.2795604317384620674 0.2298358941960056967 0.18179003945971614065 0.10927946927861087456 -0.66886228218888110764 -0.53449205237172570104 4.2818470051475658877 -0.51462158251281753252 0.53591404293572253437 -0.28204274335656842609 -0.093420598828649739631 -0.71842037164317174014 -0.80782248269055501044 -1.5280265571038826877 1.2955776076497140803;8.5702360463075457631 2.7330721315637753754 -5.4631302470169007535 -9.8516039249751159446 -12.356803442345459132 0.3039965845003997913 -13.702469004507124239 -8.6341728702664983786 -10.508419806734279334 -1.4930097244116395938 -3.5027982571342581863 -4.5843456686693198066 3.0964102967449251835 -4.6219952401898076744 4.8175227625805119303 3.2953208616935731889 1.1648970102318398911 4.8003940305247541076 5.0242078380569648033 1.6109113806974786343];

% Layer 2
b2 = 5.6086111373786442513;
LW2_1 = [0.036649825756119074061 -0.086169539021620611408 0.26250040528690621322 -0.98906522898590343296 -0.83861677869982553801 -2.9448281007798322584 0.030741863331306674284 -0.1497413159243830838 0.04050637919899714029 1.1748870314613346633 0.092653140508664647013 -0.011838359140237193073 0.049611618923483501165 -0.36091641927806039636 -0.0097956227044217972916 -2.9598488876025617067 -0.0082805926655301394929 -0.025192728094900730673 -2.5141769131608175947 -0.01876401135351558544 -1.2299756686200542521 -0.074137706932527219772 -0.046042125585474116822 -0.024316760494783699886 -1.5502001007287571355 -1.4474218364266326908 0.019209036889040249918 1.7883651437199630241 -0.063738619484525305126 0.33838015099053825319 1.2329057643221745799 0.063296227430756427101 -0.029608597909951250154 -0.039475092159493151145 -0.029729142273688172887 -1.4201638822178987986 -6.8790093745484188759 0.014866354829886328087 0.38838016047275519815 3.8112366473602921069 -0.039098167644587858427 0.069662563317197959134 -3.1271677773450048399 0.017224468177350096137 -0.14181487970749873107 0.010291947408460474719 0.035084776609319932861 -0.39286713128801958872 0.05124049976169776921 0.11333944940347479013 -0.003941736949825786103 -0.023522667733964171266 -1.0158193016162568867 0.23711466878254769397 -6.7489986116366891267 0.23280410800185050157 0.03418930481483492545 -1.0276742673180179199 2.796657829707235976 0.32107727957530352025 0.16055813390935136376 -0.045550614373203145158 3.3818385872733482955 -0.030963109100366231763 -0.068907674673564289769 0.067171726288382582748 3.7878751959208467603 -1.0291026038802362219 -1.9801292868480704357 5.2992554331295549375 0.11344959054844731827 -0.19949469420325455227 3.4661462348274030276 -0.036250286277348692243 -0.098754077873106596575 0.067788187698261934133 0.095067389747359884455 1.8718594950978806324 0.052699708238921345871 -0.016720256960472638236];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 27.5584583798382;
y1_step1.xoffset = 0.004633;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
