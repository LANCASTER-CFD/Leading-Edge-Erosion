%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           --- LEE2AERO ---                              %
% Opensource machine learning based tool for assessing blade performance  % 
%          impairment due to general leading edge degradation             %                      
%                           ----------------                              %
%                              Software by:                               %
%        Alessio Castorrini, Andrea Ortolani, Edmondo Minisci,            %
%                         M. Sergio Campobasso                            %
%                                                                         %
%                          Reference article:                             %
% Opensource machine learning metamodels for assessing blade performance  %
% impairment due to general leading edge degradation, Journal of Physics: % 
% Conference Series, Vol. xxxx, no.x, ref. xxxxxx, June 2024. DOI: xxxxxxxxx.
% 
% Copyright (C) 2024 Alessio Castorrini, Andrea Ortolani, Edmondo Minisci, Michele Sergio Campobasso.
% These models are free software: you can redistribute it and/or modify it 
% under the terms of the GNU General Public License as published by the 
% Free Software Foundation, either version 3 of the License.
% These models are distributed in the hope that they will be useful, 
% but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY 
% or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License 
% for more details.
% You should have received a copy of the GNU General Public License along 
% with this program. If not, see <https://www.gnu.org/licenses/>.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [Y,Xf,Af] = ANN_CD(X,~,~)
% ANN_CD neural network simulation function.
%
% Auto-generated by MATLAB, 17-Jan-2024 06:03:55.
% 
% [Y] = myNNF_Cd_R_AF1_80(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 14xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.02;-0.02;0.0005;-10;-0.0008;-0.00015;-0.4;-0.00015;-0.4;-0.075;1e-06;1e-06;2.5e-07;0];
x1_step1.gain = [33.3333333333333;33.3333333333333;285.714285714286;0.0769230769230769;833.333333333333;4444.44444444444;1.92307692307692;4444.44444444444;1.92307692307692;10.2564102564103;1250.78173858662;1250.78173858662;35714.2857142857;0.0078125];
x1_step1.ymin = -1;

% Layer 1
b1 = [-11.295110158630423669;11.329680799025917182;-3.032234400422876508;3.499797309388319011;-2.7205639578011640012;0.49922654423694662329;-0.69164289120034772029;7.4057044015953650273;0.20305205917179733333;-2.3268605432165241353;-0.8453657472794600114;-7.3107929242716522822;-16.188543830982720095;-3.0384305350683424862;3.8137045978125132528;-0.50631983630847310351;1.0223065635236301407;-0.14661943139470570707;-0.78737449758516453446;1.1881792716487391548;-0.21946092292152902248;0.058363589324159512173;0.77392373061598329631;0.21114714561495726008;-0.27528089221522800134;-1.6683123674317317242;4.0987792225404406921;0.46623667494304865677;-7.1606402478917727805;2.1949203822975413836;-2.5405378401024267809;0.50355373657904434204;7.2623377499990962036;2.22919244876217304;-0.51736423576777024191;-2.3075030908235381055;1.4926381095484380079;2.2389814287238878343;1.0135395583958162202;5.9294331051613458072;3.6344353729861311741;3.0713700475008050006;-0.031693830755811967792;-0.0046453998613132478634;-4.4254802053027733066;-1.5514005484792117162;-0.043941502666983503489;6.6871823737676976407;-0.57008604613945756956;5.9367355981841800627;-5.6274532120666123092;5.4737278540880609512;3.8555909728140953519;-2.7546459745831342047;-3.6595017118490975605;2.0260293294268509889;-2.2465594594653888194;2.7288912075029245763;2.8688204404330166497;-2.8872686074795654854;-9.8983393897770408643;-7.1912047178296303329;-1.0530863982676519353;-4.042554384613429086;4.1329969730802007533;2.6264416401553192237;-1.3629487247477400924;3.0015996370108752878;-0.54038140770236353649;3.930649402492409461;5.0128506749756818195;-4.3368791787098679436;0.87365073050838037982;-1.8052424706589247361;3.3549221850724206817;-3.1253016695312916262;-8.6785776047689306978;-4.15904707763547421;-3.5143211010588859544;-4.2683973012982647788];
IW1_1 = [3.2577753423040043401 0.89719539818419280497 3.073584676672187932 -3.2187421536213447482 0.69984786777886520692 6.3521294377396211317 0.60857983290980632862 1.3619178603880395251 0.10555221957462194993 5.2627196648042167126 -3.8830620916215905503 -1.3035326431365439337 -4.2727683365860782416 6.4775576349637873363;-0.86596799515359945687 -0.81299850673215035002 -4.4808659811935722672 1.9285485756867501994 -0.62879725465475877488 -6.3495353708942259274 -2.6915301524054262572 -1.381888983943541982 0.1195318610151322597 -3.5882262977414591809 3.6950721690003351938 1.1136687644376139783 4.6317578988341505664 -5.8571226541420813305;2.6647025121499594569 2.2503532978675870879 -1.1613933330055778992 -1.5801727364319493319 -0.37328568180234400486 0.23641969158119419125 0.014401849857246112191 1.6779482748920167001 1.2123819715445665057 -0.93775109981838378204 -1.1766514044951832396 -0.8254945820726315997 0.5392789939527017351 0.87083813645058005815;-0.95663934942983253062 -2.5818671552239034206 -0.4318270317935504754 -0.043468074372403936456 0.024359789829570883957 1.1884703374664509212 -1.2406611226746440124 -1.3871699526258516322 0.53507050035946768229 -0.85248531902503632551 0.015536166434403380146 0.94373610950689701404 2.2773677968593881715 -0.27529207432718988402;2.3883457719759118021 2.514895866289027726 -1.6831600067127330256 -0.28137859859112906991 -2.7141245363320738448 2.1142458914260675584 1.8571033849419302797 4.4226465541946122784 3.3298758351112343057 -1.7622988291492460711 -1.6100644608740746211 -1.7812341144003247528 0.0042152401442064882028 -0.028892432573466783619;-1.6005445972123009124 -1.8814684585293333097 0.63608065212846198744 -1.097252972009843619 0.55971057775756916097 -0.36471732380869625878 1.1260726848538264999 -4.7136385675674468132 -1.9348503519652351379 1.0985231373528836496 0.25303921404242213367 1.1000212199436638638 0.11012144644854815478 0.26981477962057381914;0.73199147193681135537 -0.4395647953679477915 0.59091616604489416442 -0.069093241670427796297 -0.7850504560187626657 0.67378745601517064934 -0.0077112243651552532867 1.0933697542031377559 -0.1910603540547963497 -0.20864605213664974559 -0.31306554976538220059 -0.1340165879979266228 -0.28385778956973628517 0.1093126030910812202;-5.8007195712801964405 -8.4102558436972678635 0.068774134159863553606 2.0381538914304608845 0.16738789613461169115 -3.0209532158762701926 0.15792446958689135283 -0.2976387954763597965 0.71739199199519210204 0.30678130553144078441 3.1935144504093471163 3.6744925015395817347 0.54715113297644923929 -2.8434366373088795221;-1.0029035329920445996 -3.0648619050339971359 0.31459096632304583974 -0.1188682132490523069 0.5780355582444328677 -0.28560356104546730238 -0.55994045924699531458 -1.2100002277417065688 -1.2672757163715249185 1.2348946217179368467 0.44410374137790792348 0.77868455307635131568 -0.081598845690314433798 -0.74003680353893264154;1.6354112257818751441 2.8247709964386951143 -0.35455885836821238177 0.79088270338119281977 -1.6989201862220515427 0.55292576837654749955 -0.94388956479656738185 3.7899073951059949472 -1.0130233927831804319 0.99549134031839492387 -0.412836099247483157 -1.8636605422960181855 -0.36054481257546183715 -0.073828458967489435372;1.5813369043930123325 0.0080081562718512383503 -0.31375676747297526203 -0.467733229798545036 -1.0251201311642113012 1.1953839659763292325 -0.077345303233079601424 1.4662216607627640563 0.53660055289043662174 0.16622437060629610683 -0.61419410774825788923 -0.44977942361999090348 0.12651765138634402108 0.12093782811658758403;2.7819536790927035241 5.7548764765775572982 2.2648334147659689997 -6.6721452656413440252 -0.22919743246591928187 1.4421442484227018355 0.88686452665807047335 1.3705349421200345716 0.84401370837930744795 3.2384802624131632243 -1.4035693362149832542 -4.5984890969512148828 -1.3855825233591769763 3.6230772651371085935;5.1145288187727251383 11.561323988574345734 6.540734959809761051 -10.321929286844659046 -2.0410172322779764897 2.3843424644214068486 1.9480286546102727474 10.335846447119575231 -2.7317450896725361531 4.049665532127899148 -2.143122469705372346 -8.87851125523172513 -5.8483367139069377671 11.167741271321846241;-0.33600202104537624237 -0.8961944207296600462 1.9977569702605557644 -2.19615046037353423 -0.37590022994979349624 -1.5260081400682703467 4.1241735439943578712 0.14931144389428940844 6.6429877058001896017 -0.060787318567854485563 -1.0236105490010607433 -2.6055607301270251597 -1.1369539213764128238 0.19820326573715660312;-2.143149919675185533 -2.4372108074022684754 0.5275975570782283075 1.662422292995617612 0.39661119723274901316 0.80387019045931940031 -0.42445418084741298737 -2.2370955221754948994 -0.91172370391627310937 -2.0858828708946703934 0.86499908743555276036 2.7354528343993678163 0.95561119125073112901 -2.0605974983708099657;2.6138756702795884479 0.25870092999313909488 1.0528208246901988865 -0.41342073014766306249 0.93739363451918455983 -1.7522778476772569167 2.1908595821916425628 -0.45234708819046137718 0.2398719591848650079 1.7833500313780341617 -0.35190479294936422017 -0.19881223983269105671 -0.89958870528985057646 -0.097650437215699104065;0.31100720908732670811 0.9749147930474284518 -2.1591742332714041197 -0.1902700133622813039 0.37828224803319460134 -1.842810305457332154 1.2408629316180792568 -0.90811419372121082727 1.1260278336283442435 -0.48586249588400193256 0.28988923627313817333 0.35482271804859788489 1.6312367520885944217 -0.86708755725829034233;1.2205963003933970601 5.1923345142776788919 -3.3675001871090226579 0.60317595649828981141 -0.22124002334922820978 1.3968554110622259934 1.3855810034453575064 7.35433683165051999 3.1783550592405052093 -2.9031451367403788844 -0.54033535394506793104 -1.9984601969349098383 1.3206467428887072035 0.2816118846435550771;-0.37552459816407823823 0.64030853163217138491 0.11393794402522375298 0.24854676212337897812 0.66281025504496071665 0.29244582792711665276 -0.1772209043398426942 1.2180042048800223675 -0.37778025753286559318 -0.18582060402652014752 -0.30949594866024571216 -0.41569072309791316178 -0.15241167675894903843 0.47887198999354657625;1.2652954211658391515 0.84283276907754445251 -0.56074911827713780355 0.27177201132591793931 1.6255069831317576767 -1.3925561587360564264 -0.66181206294292549419 -1.5291556332679925312 0.61873677734875920375 0.21972064553621617478 0.13314855146139800701 0.27628929212401814874 0.31898854404920945482 -1.2218602273351641951;1.4051824851622096713 5.611899527647307373 -3.1550059319553231951 0.4155027371076719378 -0.22141738276768418991 1.4952991984562626904 1.4216766657111750138 7.1077453773756236188 2.8746579586866949363 -2.6790017131871439737 -0.67575265863883038353 -2.0991290290265922636 1.1650231460011235551 0.55449650878170175794;1.5434187684006408503 6.1199828347231859382 -3.2936859931581374816 0.078192996171509196457 -0.13294064542403194462 1.782628581996841044 1.8092089854562671825 7.3862007204931909854 3.608634313753211309 -2.8767691559016190794 -0.80068350313953873254 -2.2411117970824867562 1.1753230076885106126 0.86587462580475815788;4.5260112380410744137 -0.18135137451569310896 -1.934039935119461262 0.14331433590752185037 0.90972242047037521484 -1.9460069558154171609 -3.5108862826998050721 -2.6571005145436146222 -4.1083453287722360159 3.0457858114337845734 -1.2128847969445046839 1.7769895441871932373 1.3787378121896733951 -0.10878595088135634139;1.740230332725742457 6.6848080239274434433 -3.5046050501401051491 -0.13284534451686411116 -0.11130071853064288367 2.0333739913024273527 2.1011343915894906687 7.8796402938682286177 4.1508542826622356614 -3.0642899170940358644 -0.94708628499350988594 -2.4123286206987493152 1.2288345620730625196 1.1104929669834560091;0.039031956670314692237 0.48141461699614312986 -0.037583180571125376912 -0.68675232483126114058 0.6787537437469877144 -1.6361876574063647372 0.33324703505488878497 0.54811611797443793304 0.022276783508470152789 0.17259868323984078886 0.28340899179794609708 -0.54691568654404276728 -0.092303883772121106399 0.6840756832201062565;1.6578793070621897776 2.6640480841291460656 -1.181536485145793014 -0.75216132971326987722 -3.011925422242425654 3.5254704007476282968 0.66822012657905149879 1.0317169776632457712 1.0031286290171164133 1.0128033166107572871 -1.1828786072520400818 -0.32755886519032195725 -0.11939121878186426118 -0.90418532428780395982;-0.82915815333445597179 -0.71706152028007419386 -0.87974218515208313374 3.0874534619623954512 1.3313458586745727796 -0.41085288660813090722 -3.0743101149197129551 0.15921632520491857399 -0.40073330927706773963 0.067560366409411432009 1.9222932004252695215 0.33637676651328135558 0.5565093962462609456 -4.4106720338032436857;3.1590171960393016448 0.75300592177519931614 -0.45457661663323578605 -0.14184930067185302915 1.0129439886989366482 -1.1636774894577635031 -1.865013828619360714 -1.432812013621582059 -0.89431053465862153651 -0.72150215116489724299 -0.41725509416416090014 0.47094369533629121261 0.66965757467473541187 0.29545034569787703704;5.2868498086778830114 8.5707489643611811658 0.25479519727338184598 -2.1573810498492922427 0.15804918161628578321 2.7969736876919886193 -0.15954193793414778169 0.22346398669267175663 -0.81280827249711407045 -0.27920136862080757734 -2.9247858862959534854 -3.8700118268405199196 -0.67653700150068185604 3.060055054494867921;1.13693425071685561 5.3725097650497248836 -4.9381859792721982672 -1.2074442766733881616 5.7993646437491062073 1.0650255320206498677 4.9584363358073435535 2.1739863776836254594 4.6521544646282659841 -3.9784666141364533054 -0.54716158591831087765 -1.013119536053983305 2.9574340973981541048 -0.16177087987360866395;-1.0002022424453136384 -0.36056724951725338535 0.98377171147401487605 -0.55711744653923900295 -2.6194646634395812868 -1.7112802432795006791 1.076201588900048689 3.9844395130168126506 0.65640039812661155061 -1.3362164002706076182 0.37156802036651959131 -2.2015690910550365089 -1.3878920351491579321 0.77615863507065419036;-1.8658464427074739067 -1.9866630151804192117 1.1195772976268840715 0.19948608863302258465 0.82647199145092486994 2.2264722580228841764 -2.3327927915784925084 0.23835500308950380299 -2.3416430620047963274 1.2785055924566290919 -0.08275704598940696044 0.83000049431451972115 -0.91966014142224261629 0.15887304016156356123;-5.5237528715694219628 -8.4703974876340151212 -0.092057782808419627574 2.0957909875000639843 -0.0072800668836196860689 -2.9033274922451335343 0.1576680448706279658 -0.2596419933084199716 0.76706990868933444538 0.29129899102737477623 3.0509018103158114243 3.7659167438624248092 0.60886865637289555586 -2.9496649502334562065;2.2783129957044949698 1.8092074628721097618 -3.3097250770998418723 0.4720775611912643166 1.3792076212930706181 -0.61552250736569336098 3.9410563027743945597 6.0987895011749353458 6.2363507670619400258 -4.6650406752429640633 -0.3038835317394069091 1.0555247044174977944 1.2398031060834981965 -1.608274180996613234;1.5871391527395708465 1.8058921516109265326 -0.69739960830202951669 1.144243389051947446 -0.56896520370716929804 0.36329406376823170088 -1.1610823467473694315 4.7759982473816968707 1.9054299249805997096 -1.1603024063279065992 -0.24296613623458246378 -1.0766996448054881874 -0.078831815864555634943 -0.3118484708380365733;0.49943196830526387364 1.5821126446282558486 -0.40696165256692329315 -0.59883502010218536693 -0.31832045934422609212 0.68826890113836203255 0.32448095037674185015 -0.67545647862059554623 -0.4931512547956117265 0.49545094182046245379 -0.00051811051262524348074 -0.27750955262418597336 -0.86716580988068603375 1.2153075836720377279;3.4210078459704469367 0.9551491998412520168 -1.8991686706486481384 1.1600758139070868058 0.36289339016145077954 3.5049954034988641816 -3.4350966881523508079 0.30093177897110989782 -3.4123527903711976528 1.4239387567152157477 0.043175660822091371793 0.9077024676594274144 1.3771614624109689284 -0.15423650437996927476;-0.72859646880733885954 -0.34228565656923387595 -1.5011038404918444211 1.0756860333595665846 0.0011725740712306038926 -0.99252711014135885925 0.066559106712989715704 -1.8963268336987595397 1.9350699897139269634 -0.59076067425113720777 0.60304961691921854516 0.8939521281519039464 1.4119907369001256647 -2.785081083757606546;0.29648902706110169536 0.92539919513757074032 -2.0478576618949566601 -0.18293064680771509156 0.41905843411865506543 -1.8583765656212620776 1.27094397790732061 -0.86049279571421433133 1.1797011936558723377 -0.5036353768125448882 0.30523153278684433953 0.32508464325554037311 1.5424185559620102737 -0.84465793562914059933;-3.0452465900217036143 -7.2691203332948450822 -1.3262598745967777436 -1.5111340813433138397 1.4713281335624897039 -2.0407568018638171381 1.9632121235601396325 -0.90124986710798471456 2.9309267336940165727 0.99403395410801465015 1.7912579961197496736 2.8584629520022026838 1.2927382077900237967 -1.0852703218921861961;-1.7758357703470126765 -6.9023586038967437162 1.1407947757782748166 1.1020369085771422046 -0.061552983683269897608 -2.0525811885070135432 -0.64617352962769236679 -2.5145015472682086255 -0.54246622300285174401 0.86435213464807958417 1.1731172722057876534 3.5400449520047181373 0.017152180147268495519 -1.8550179053049833389;-1.9964955132234001312 -1.186293954320344568 0.29763470166824051999 -1.525844508712451697 1.0570550422143034641 -0.82761552164341722904 -0.10597023827792372008 -1.1574951434901830094 0.11201156267233183805 -0.33267355678441246081 0.86823502748410397167 0.78358884244955506748 0.23188167628491609951 -0.34489632649253887386;1.198061144747755824 5.0249568795351802208 -3.6771153769618889484 0.79676514887907623486 -0.19080079521600298853 1.3342985525387724977 1.3281939861913716339 7.842555023451225793 3.3963716689563039353 -3.129614846743073997 -0.49674597645718060468 -1.8721270139380927766 1.5232036818924910015 0.088409653816194977427;-2.1773982098977899824 -1.8800245499562986407 0.88033682107865762756 0.85076417054106889815 0.39419954333001039348 2.1715943077130019923 -1.8403290558690978962 1.7520708141134355706 -2.8095577230848176598 -0.047488107656055926487 0.25733380969124824977 0.65831612597549771237 -1.2305945501555626276 -0.1926422241360841725;1.4558419068360275439 4.7533229475543281595 2.7410110762241068905 0.63774494207631804432 -0.95971725224461923442 0.73679349193884269287 -0.16957220837884975917 -0.80866521743018049406 -0.65349524627771238272 -1.8757814250956184043 -1.0437996173309536108 -1.7219396529825514719 -1.3335156165258061911 2.0218488544420178954;0.57671457104686141282 1.7512863571204166924 0.88767878011089607071 -1.8497939528492681749 -0.76492509035893463398 1.5193947842473025656 1.8131216550990381098 2.4278510572166829284 1.4697144462360114403 -0.67805003908602468066 -0.91429425112308160273 -1.4309267583859943684 -1.2302601128356183136 2.6086269565901578638;-1.2469189140859218146 -5.4186204753427098524 3.2483363523134904938 -0.26406630531995711753 0.13423624587696195154 -1.5783110930394852467 -1.652282385276444554 -7.138646587342972083 -3.5717181669998616655 2.8921087675503613923 0.59815365455224123181 2.0821898595529697573 -1.2060063857837484136 -0.55435978775957284181;2.072217599427880419 1.5046960864992835472 -0.32315241599297733766 0.20665433130584545673 4.5709338909601040513 6.1102971475992289285 -3.9055649347175482866 -6.095359437067259023 -1.0944818928138266845 1.9645007157658429531 2.0062743834729790393 1.2848932857747776826 1.5933234041225734501 0.23616181320861626136;0.12136848412351924908 1.4078443133382938512 -0.17145652725833471219 -0.12330403281662674631 -0.060754285590878268075 -1.0066797730939840427 1.7578854162080845835 -0.15711637231218014699 1.5046856130421588649 -1.8857951386514013592 0.19534847523124782009 -0.26508736494806034445 -0.26134947233612820794 -0.22453694156427322914;2.4002719328505333074 1.8319609610931097965 -0.61485372316954078897 0.20143406679024053463 3.9557631724208381918 5.6212593527308465369 -3.7697434006699825915 -5.5228360092630186529 -1.1960357802613339473 1.7465251934459458116 1.6443640457370918284 0.94783685438415399283 1.6779313447502826051 0.37749574481567010897;2.0710793706058829855 4.7601451293297856182 -1.1193843205426121656 -3.3061280282744718306 -0.159902082647010918 5.0391336015965864092 1.9690050604356392761 4.4265414723802285479 5.8768846140890618202 -0.0053275022616952050214 -2.7497605651420058415 -5.0831525293090500384 -1.0865846470318301087 3.289150526357851323;-0.78343425905784869201 -2.6472736047990044206 -3.7825168764896188733 3.2929356102041209553 0.075158318837381624111 -1.4715168381182468504 -0.80595144905863058682 -7.2388454121140277664 1.5308396467406297781 -0.23961108988297052935 0.51687878828052569169 3.9974069743935007892 4.0174086087333265027 -5.2578297494274659485;-0.58206208225866895578 -0.55598681465599741891 -0.64702669483312003074 1.2598298731969794773 0.43564205964096963664 -0.89136086839490025202 0.59308464484884193535 -1.0326926279646535534 3.5597695316389996734 -1.1105198890016534374 0.45890329896902687379 1.0042150191111463009 0.45064778316492376531 -1.4006429685031003274;2.4038240923615417088 2.5388013423505739752 -1.7103182853510758843 -0.30513758832817888811 -2.7300437774876655794 2.100121512249383926 1.8541142383802087235 4.4603526685512413508 3.3742808781611448588 -1.785739261827944846 -1.6085300402131319508 -1.7946828709334881058 0.021112479932732672316 -0.045426009620668200695;1.7646688414201980866 6.9200249076588917774 -1.1938730645248694096 -1.1055809168642751761 0.057177861588228004464 2.0592815475420609417 0.65930038878561214588 2.5887213402405064855 0.57161172970829798867 -0.88638373104177126116 -1.1680511816572576311 -3.5617411729488352989 0.003316537500688864111 1.8358424408578382092;3.7964926329235564317 -0.2406621065203975729 -1.7448403466545567841 0.52192515094097935435 -0.21554223130220026561 -1.7883781768013398139 -3.0699105384031111221 -2.2581412511923497632 0.06632957720842735938 0.59561673780997148597 0.21625209973434719735 0.84347895097067815406 1.703518878687609206 -1.2103604365630942219;-0.46288629593894009551 1.3423168165536316643 -0.86350261710563325224 -0.090857492718904878104 0.10149827962598964581 -0.10465679396149157876 1.209147950711139341 -1.3218859833773219936 -0.95584466213012486691 1.8328251394528849438 -0.08888788616057537173 -0.18877455960221234399 -0.138146826038357734 1.3900414362989994554;3.7211532847772481603 1.3186457264412616563 -1.7500370870831241099 0.83373371455270539609 1.0841390815967870687 1.6585590030407175721 -0.91188135262049707652 0.51550785529492881842 -3.0988923998681610072 0.66350417228711977558 0.67999401665257241945 0.4655709289181740318 1.0547169629413366554 0.34091293481472867422;-2.166405610505699908 -2.4579995121048012763 0.65372233707632176891 -2.2759230424828840178 0.36956670041780442793 -3.2603540762921001672 0.99405585518012529178 -3.1403928103079965517 2.479874744355116345 0.63847966577927173226 1.9068645640388135476 0.34024746862648647117 0.74869099743111233725 0.39273824940399554295;2.1888391068886772217 2.4763771097903237717 -0.63195778053799878116 2.3171583925702061713 -0.39246185077402329089 3.233949463771158328 -1.0159100954730626576 3.1195321829019255766 -2.512324475443385996 -0.69808086106341071808 -1.9078578108850345885 -0.33846221247180713343 -0.75879200998052909188 -0.37132908218829974167;1.0069390094144363701 2.0443910951761896655 0.35057832159979362974 -1.5909697318685811496 -0.030152185936399632932 -0.60111676811293734968 -0.22182402206064485983 9.1555698160026057764 -4.5648775822354030751 8.4761557094472479434 -0.6716104745529841713 -2.214279326432420536 -8.6391330374076300558 1.9184060827443960573;-2.2337923095264766715 -1.292958548635050775 1.9884188395474478028 0.27644353318247183449 -6.7392430064568831227 0.97882578381868023953 1.3504542523553868527 3.3107000048648291823 0.13694933077680826461 -1.549443289011793734 -3.4203819104000072748 -1.815182493419543075 -1.680998081958151813 0.66926257595876659234;3.2586494396919625238 3.1131445739264234085 -2.6520280683947863309 0.46867506404751618776 -0.28958022026737972876 -0.65075408699521641864 2.0204644542590437517 2.2183020211086721396 2.7692524215985430125 -3.3026776311715062562 -0.78236063661651333856 -1.4236692830996238168 1.6509941052548258167 -0.083816753334014795773;-4.7172081984635658714 -4.0017708823250757177 1.5920614157286478996 -0.062606694301653886825 -2.1150851318639616316 -4.7006684886759426689 4.7772175520297768259 4.7161832838840247462 2.0227154686790544957 -1.3509134824271937791 -0.80235197199612751096 0.38272918911411679677 -2.1870578107685685332 -1.1553836021939005718;-0.70283043254445887182 -2.0085033961879914521 0.74524864445488581133 0.64473457445508675079 0.030421001643228969685 0.72949304867569286781 0.20095132189129769062 -0.56035332564233120145 0.89026644542934596505 0.73500629146447793438 0.26515199848107351421 0.69294320723489133407 1.4722258677766439927 -1.5174249312842678084;3.8996897781791761695 1.4262559323177239623 -1.7244785828570421415 0.75020299585740179982 1.0238720406287415976 1.55893764986734773 -0.877979394746121522 0.50155940940120413707 -3.064015488701900658 0.68835516164440180287 0.57143469586187656262 0.42090833694742546545 1.0199037355309870101 0.39122462822455283948;-0.88286588556295719776 0.3665862253635993051 -1.2908749378641528605 -0.15261040787033536281 -0.53188646501233949326 -1.98602173825722228 -0.069307010828063855823 0.21183670031247014975 0.65527999028105154977 -0.23461474532414219873 0.4794074679496398983 -0.54338841824628736354 0.92766497455056440291 -0.82359513843174869674;4.3233602282819578733 0.18143116660419786323 -1.6757395057778541325 0.26399739201923111409 0.22350335825953721036 -1.9095202543078679813 -2.5655670440294615631 -2.3241855439176473119 0.56809653420927497258 0.48233031495513861708 0.86106742160275695497 0.81448112662560179231 1.6287149942770431377 -1.199210573844642802;0.09738837547873580025 1.2770650419164975009 -0.27832097483721202069 -0.06137746219711111284 -0.036732502399305956564 -0.92602166111437589358 1.6296157490099798526 -0.10555144296146351524 1.5562181373893066993 -1.9017806682041735744 0.173644445663255792 -0.23021553664091357061 -0.212393150940432901 -0.26514832408161187471;-0.7402611406369787872 -1.7613822905088696302 -0.66151557336049948699 -1.5354754087386244255 0.098927967889818363423 -0.67747356184951224023 0.13096516843761729643 -1.1027997789000707485 3.1782919253299422024 -1.4261083709409128062 0.48590453916138015567 0.66336004485451016688 1.1079705986092678316 -1.5262008991380564549;3.0318254044267205494 2.4092389742686814991 -0.99445799403540824368 0.17522055179135787029 3.1730504863289716866 5.0707903009653332305 -3.8699304234669127389 -4.9409536363504731327 -1.4206066406242894296 1.5197007167675000705 1.2053284060260018862 0.48412537740809552522 1.8185688797064205602 0.60734389949591538471;-3.9070673972902927318 -3.2220320729346241251 1.3444051506227561177 -0.11942315006710112202 -2.5098628463351300155 -4.7512312254434094783 4.2910142210328547918 4.6783325820449119803 1.7349865980037568747 -1.3861785319759134527 -0.91115344112417173683 0.0016519508022404495381 -2.0061798649176196818 -0.89676871211918052218;2.6648407139061371929 0.46585611186222658509 -0.23463354694716045956 -0.058334707215149807225 1.4495677874502599369 -0.82551037259319604011 -2.4487701560275221269 -1.6146786662174463789 -0.82178194693154971162 -0.67538808036609165875 -0.3044066768984871052 0.55821114674113214704 0.54018702376743754634 0.40268842926013309613;0.4235068045113184465 1.4212312557036335114 0.0081189014171945059206 0.37110711828601111728 0.42941379924190725692 0.28556323430596636248 -0.2725837134085370983 0.91829684864966321101 -0.23986812152165182255 -0.49031711485450663046 -0.55507180076562223636 -0.55022736711772080032 -0.0043259702332744866954 0.36767711254052803937;0.13163056431018499426 -0.43147127688476710761 0.46056427074138156508 -0.26328992493371017325 0.40300271021130829041 -1.0495921172492270745 -2.1657149744563728433 -0.98560053084694210224 0.39107979111115437343 -0.62492278894035557801 0.33940295057691483027 0.19724848008804665711 0.84245424117220368831 0.50295918592417687698;-0.9557262952998497596 0.5585457150855470676 1.1714440827514358556 -0.51576111299855831316 0.31238535514159265771 0.98402332593848307329 0.35909950036387672245 0.89900968540574566212 0.64714344495268427693 -0.24400683439612963488 -1.3620530708393681074 -0.83881874428206559813 -0.90665310687712341586 1.486081839624286749;-1.6221642265680396022 0.99775743690161378119 5.7393235004681653066 -5.1654000120645502392 0.58378247371576441616 6.5752082532535363057 4.9418252339560382325 1.4506727075182650477 -0.60719602293904351153 2.3738715442838644876 -3.6031914219535066124 -0.99717215202709708066 -5.0815053894332233853 6.7454376242668425689;-1.6433648753328193859 1.0839422497861856964 1.8424161005388650647 -1.1480629350143320977 -0.85792104016020531709 2.189588882347625276 1.2734001497658697932 2.7095872338208608632 0.8225867812339627827 -0.6911749356372489661 -1.8721817501379360849 -1.5163235805790664656 -1.8577541321797490514 2.1031293795792525003;0.8146164869175352985 0.96671905259451273995 1.7203711822808154253 1.964357984156678949 -0.57437984198516167655 0.82697806759666014909 -0.88636505363316042683 1.7340184624452790185 -0.35616657420739983309 -3.1324254774574198379 -0.87756545435086330542 -0.28677158517924572489 -2.136909796524457672 0.60295819214345991455;0.86073615105058876029 0.69860112065989654617 0.93792273953227245364 -3.3292634320914649138 -1.3590232257689811579 0.41484601007516580529 3.3409861941379634942 -0.14671482729599774619 0.42779297467270227529 -0.11647526264939256357 -2.0614679552201842228 -0.31999517428053497747 -0.62342436177070625902 4.7123188602821279858];

% Layer 2
b2 = -1.4812378830490036119;
LW2_1 = [-3.0205907392618445151 -6.6197213107284422762 0.25611081468665058969 -0.19200407414724421362 2.3190278763735605594 -1.275528627929268799 -0.51195815027130064934 2.7284557636103046185 0.19837610986427853255 -0.07352808954269346442 0.2928811021008997928 0.057641502979159951747 0.073796642559600320044 0.10783942346890619535 0.11161977200256155418 0.036428787427626618811 2.390603753332574577 -9.2068858935734283477 0.96830921547692216933 -0.13113688086499133978 7.184266409541893772 -10.282127024465188114 -0.044083560824034022374 3.5654050661041098991 -0.41879825561114014665 -0.049356164243815829618 2.0224137021613102227 0.43288743401063539684 -2.7035906563881333398 -0.026079874214037658542 0.09281515568227063917 -0.14739813304838356167 -5.418948128189072122 -0.028873479491354943349 -1.2685508424641012137 0.61658113350986409884 -0.078150399319710989188 0.36658518332278727803 -2.5414583515546906867 -0.049874151756692811088 2.3887576871855413785 -0.31326900686703590404 2.7238358204873889257 0.10927598456503201385 -0.089441152271696494624 0.083494574610611285714 -6.1461737708897290489 3.4960238530492033782 1.7710473568229048169 -9.9062760856846399093 -0.032144952455861450225 -0.070957038293751564795 -0.53545800989792313729 -2.3059744624370392962 2.3899935633727666939 -0.76359095792809628112 -0.27466204915561959199 1.3855007796017926314 -1.5922630315261401268 -1.5983021229693867848 -0.4061982162106043126 -0.13099420100117639687 0.065611972133940724139 -2.8435515219559373001 0.34703757162790282997 -1.3242393823844920142 0.092604967423524711667 0.79974420209308816343 -1.834826790861653123 -0.51378571624836510967 12.436028050123365318 8.8384376492815501791 -0.39599627672691661839 -1.1471557017421696312 1.8504398904111951651 0.96746306596410336365 -3.5179092466072621193 -0.31195867696285295434 0.1728700651020820267 1.7313698545424682784];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 9.36145514458767;
y1_step1.xoffset = 0.007549;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
